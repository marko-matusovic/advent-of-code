import time

def part1():
    (rules,input) = '124: 72 26 | 58 91\n76: 72 90 | 58 73\n89: 58 135 | 72 25\n43: 58 30 | 72 98\n130: 58 58\n87: 135 72 | 100 58\n24: 72 5 | 58 78\n61: 84 72 | 71 58\n8: 42\n68: 49 72 | 91 58\n103: 126 58 | 124 72\n132: 58 17 | 72 37\n75: 72 89 | 58 50\n99: 72 72 | 58 58\n28: 58 19 | 72 65\n2: 9 72 | 67 58\n113: 58 100 | 72 130\n66: 129 58 | 70 72\n74: 72 116 | 58 56\n45: 72 82 | 58 38\n70: 137 58 | 12 72\n78: 72 58 | 58 58\n115: 78 58 | 27 72\n48: 58 121 | 72 95\n23: 120 58 | 93 72\n44: 58 25 | 72 130\n17: 58 27 | 72 91\n65: 102 72 | 46 58\n19: 72 84 | 58 35\n79: 29 72 | 127 58\n13: 58 88 | 72 136\n6: 15 72 | 130 58\n81: 58 72\n100: 117 72 | 58 58\n116: 78 72 | 49 58\n136: 20 72 | 50 58\n97: 53 72 | 85 58\n107: 58 27 | 72 5\n0: 8 11\n49: 58 72 | 72 117\n88: 105 58 | 21 72\n83: 69 72 | 5 58\n112: 58 32 | 72 2\n47: 62 72 | 118 58\n59: 58 134 | 72 101\n60: 132 72 | 103 58\n55: 58 44 | 72 92\n67: 72 15 | 58 100\n96: 81 72 | 135 58\n121: 25 58 | 26 72\n39: 58 81 | 72 25\n82: 81 58\n27: 72 72 | 117 58\n85: 58 119 | 72 68\n53: 72 39 | 58 80\n91: 72 58 | 72 72\n129: 58 133 | 72 3\n18: 58 69 | 72 25\n120: 110 58 | 36 72\n114: 58 87 | 72 16\n34: 72 40 | 58 45\n29: 58 123 | 72 59\n36: 15 117\n133: 58 107 | 72 113\n109: 58 58 | 58 72\n46: 100 117\n41: 109 58 | 91 72\n26: 72 72 | 58 72\n72: "a"\n21: 58 78 | 72 130\n117: 58 | 72\n111: 58 5 | 72 81\n95: 58 27 | 72 109\n4: 97 72 | 28 58\n135: 58 117 | 72 58\n37: 58 27\n1: 58 99 | 72 25\n52: 130 58 | 109 72\n106: 5 72 | 99 58\n12: 111 58 | 68 72\n42: 94 58 | 79 72\n11: 42 31\n77: 125 72 | 86 58\n98: 58 91 | 72 109\n62: 58 122 | 72 52\n119: 109 72 | 135 58\n108: 15 72 | 25 58\n10: 78 58 | 15 72\n5: 72 58\n3: 72 33 | 58 37\n57: 58 51 | 72 7\n7: 72 43 | 58 74\n38: 58 91 | 72 15\n20: 26 58 | 130 72\n22: 58 99 | 72 15\n105: 15 72 | 99 58\n25: 72 72\n35: 72 99 | 58 91\n56: 78 72 | 99 58\n63: 114 72 | 55 58\n86: 23 72 | 13 58\n54: 47 58 | 112 72\n50: 72 5 | 58 99\n126: 58 81 | 72 26\n127: 63 72 | 60 58\n9: 72 27 | 58 15\n137: 10 58 | 96 72\n15: 117 117\n128: 66 58 | 57 72\n58: "b"\n14: 18 72 | 116 58\n92: 58 25 | 72 100\n40: 83 58 | 131 72\n31: 77 58 | 128 72\n69: 58 72 | 72 58\n125: 34 58 | 76 72\n110: 117 99\n94: 72 4 | 58 54\n102: 72 25 | 58 109\n30: 58 91 | 72 5\n84: 99 117\n93: 50 72 | 6 58\n80: 72 100 | 58 91\n64: 58 5 | 72 130\n51: 58 61 | 72 48\n122: 5 58 | 25 72\n16: 58 130 | 72 78\n90: 22 58 | 106 72\n131: 58 91 | 72 130\n123: 14 72 | 75 58\n33: 58 15 | 72 26\n71: 27 72 | 69 58\n73: 104 58 | 24 72\n32: 72 126 | 58 41\n134: 72 1 | 58 35\n101: 72 84 | 58 115\n104: 130 58\n118: 64 58 | 108 72\n\nbaabababbaababbbaabbbbab\nbaabababbbabaabaabbbbbbb\nbbbabaaababbbbaaababbabbaabbabba\nbbbbbbaaaababbaaaababaaabbaaababaaababba\nbbabbaaaabbbabaaaabbbbbbabbbbbaa\naaaabaaabbbabbaaaabbbbbabaabbbaabbbaaaabbababbbb\nbbbabababbbbbbbbbbbbabbbababbaba\naabbbbaaabbabbabaaaababaabbbabbbbabbaaabaaaaabbbbaaababbabbbbbbabbbbaaababbbbaab\nbbababbaaabbbbbbabaaaabbbbbbabba\nbabaaaabbaaabbbabaaaaabb\nbbbabaaabaaabbbabababbaaabbbbbabababababaaaaaaba\nbbaabaabbbaaaabaabaaabaa\nbbaabababbaaabbbaaaaabaabababbbbbaaabbaa\nbabbbbaaaaaaaabbabbabbba\nbbbbbbabababbabbbbbbbbba\nbbaaababbaaabbbbaababbbababaaaabaabbbaaaabbbabbabaaabbab\nbbaaaabaaabbbaaabbaaabaa\nbaabbbaababbbbaaaaabbbbbbaaababbbbbbaaba\nabbabbbabaaaaaaabbabaaabaaabababbabaaabaaabbbaaa\naababaaababbbaabababbabbabbbabbbbaaaababaabbabab\nababbbbaaaaaaaabababaabb\nababbbaaaaaabbabbaaabbabbabbaabbaabaaaab\nbbaabaabaaabbaaabbbbbbbb\nbabaababbbbbbaaabbababba\nbbaabbaaaaaabbbbabbbabbbabaabbabababaaba\nbbbbbaaababbabaabbbaabbaaabbbbababbabaabaaaaaabaaabababaaaaaaaabaaaaababbbbbaabababbabbb\naabbbabababbaaabbbbaaaabbabbbbbbabaabaab\nabbbabbaabbbababbbababbabaabaaabbababbab\nbaaaabaaaaabbababbaaaaaabababbbbabbbbababaaaaaaaabbbabab\naabaabababbabbbbbaabbaabbbaabbba\naaaabbbbabbabbabbaabbaabbaaaababababaaaabaabaabbabbbbbaabaaaaaba\nbbbaaaabbaabbaababbabbbaabaababbbbaabbbbbbaabaaaabbbbaabaaaaabba\nbabbaabbaaaabbababaaabbabababbaaabbbababbbbbaabb\naabbbbaaabbbabbbabbababa\naaabaabaabbaaaabababaaabababbaabbabaaabbabaababaabbbaaab\naabbbabbbaababbbbbaaabaaaabaabaabaabaabbbaabbbaabbbaabba\nbbaabbaababbbaabaaaaaabbbbbbbbba\nababbabbabbbaabbabaababaaaaaaaaabbbaabaabbbabbba\nbbbabbabbabbbabbabbaaaaabbabbbabbbaaababababbabbbaaaaaaaaaababaaaabaabaaabbbababbbbaaaab\nbabaaaabababaaaabbabaaaababaababbabaabbabaabaaabaabbabba\naaabaabaabbbaabbbbbbabbababbabab\nbaababbbbabaabbaabbbaaaaabbabbbabbaabaabbababbaabbabbbbaabbbbbbb\nababbaababbabbbbbaababaaababbaba\nbaabbbabaaabbaababaaaabbbabbbaaaaaaaabaaaabbbbabababaabbabaaaabb\nbbbaaababbbbbbaabbbbabbb\nbbbaaaabaabaababaaabbaaaabbabbaaaaaaabbbaaabbabbbbabbaababbaaababaaabbaa\naabbbabaaaaaabbbabbabbba\naaaaaaabababbbabaabbbbba\naaaaaaaaababbbaababababbbbbabbbbabababaaabababaabbbbbaba\nbbaaaaabababaababbbaabbababbaaababbabababbababbaabbababbabaababaaabababbbbbbaaba\nbbaaaabbaaaaaaaababbaaaa\naaaaabaababaababaaababaa\nbabaabbbbaaabbbabbabbbbbbaaabbababaaabaababbaaaa\nbbbbbbaabababbaaaaabbbbabaabbaba\nabaaabbbaababbaaaababbbbbbaaaaababbabaaabbbaababaaababaa\nabbabbbabaaabaabaabbbabbbabbbabaababaaaaaaaaaaabbbbabaaaabbababbbaaaaaaababbabbbabbbbaab\naababbaaaaabaababbbaaabababbababbbbaabbbbabaabbbabaabbaa\nbbaabababbbbaababbaaabbabaaaaabbbabababa\naabbbabaabbbaabaaabbbabaabaababababbaaba\nbbabbaabbbbbbbbabbbbbaaaaabbaaabbbbabbbbbaaabbabbbbbbbbbbbbbbaababbaaabbaaaababbbbbbaaab\nabbbababbbaaaaaabbbabbabbbbabbabbbabaabb\naababbaaabbbaabbababbaaa\nabbabbbbbbbbaababaaabbbb\naaabbbaaaaabbbabbabbaaaa\nababbbbbabbabaabaaaaabaaabbabbaabbbbbaaa\naaaabbbabbbbababbbababbaabbbaabbaaababba\naaabbbabbbaabaababbbaaabbaaaababaabbabaababbabaa\nbaaaabaabaaabaabababaaba\nabbbabbbabbbabbaaaabbaab\nbbabbabbbaaaababbbaaabbaabbabbbbaabbbaaaabbbaabbaabbababababaaba\nabbabbaaaababababaabbbaa\nababbbaabaaabbbabbbabbab\nbbaaabbbbaaaaaababbbaababbabbbaabbaaaabb\nbbabbabbaabbababbaabbabaaaabaaaaabababaaaaabbaab\nbbaababaaaabbbaaaabbbbabbbabaabb\nbbababbaabaabbbababaababaabaaaab\nbababaaaaaaabbbabbbbaabaabbbabaababbbabbababaaba\nbabbaabbbbbbababbbabbbbbbaaaaaabbabbabaaaaabbabb\nbabbbabbabaaabbabbbbaaaa\naaaabbabbbababbabbaaaabaaaabbbaa\nabbbaabaaababaaaabbabbbbbbbaaaaabbabaabbababbaaabbbbbbbabaabaabb\nabbbabaaababaaaaaabaababbbababbaaabbabaabbbbaaabbbbbbaab\nbabbaabbbbbaababbaaabbbbabbaaaaa\nbabbbbbbbbbabaaabaabbbba\nbbbaaabaabaaaaabbaabbababbaabbabbabbababbabbbabaaabbabab\naabbbaaaababbaabbbabaaab\nbbbbbbaaababbbaabaababba\nbbabbbbbbbabaababbbabbba\nbabbabaababbbaaababbabababbbaabbbbaaabbbaaaabbababaababb\nababaaaaaaaaaaabbbaaaabbbaabbbbb\nabbbaaaaaaaaabbaababaabb\nbaabaabaaabbbabaabbabbabaabbbbba\nabaaabbbbbabbbbbbbbaabbbbbaaaabbbbbaabbbbbabbbababbaabaa\naaabbbaaababbbbabbbbabbabaabaabb\nabbabbbbbababaaababbabababbabbbbbaaaaaabbbaabaaaaabaaabb\nababbabbaabbaaabaaababbb\nbbbabaaaabaaaaabbaabbaabbbaababaaaaaababaaabaaabbbbbabaa\nbabbbababbbbbbabaaabaabababbbbbbbaaabbbb\naababaaaababbbaaababbbaababbbaaabbbaabbaaababbba\nababbbbaaabbbaaaaabaababaaaaaaaaabbababababbaaba\naabbaaababbabbaaaaabbbaa\nbbbbaaabbaabbababaabbbabbbabaaabbbabbabababaabab\nbabaababbbbbabababbabbbbbbbbaaaa\nabbbabaaabaaabbbaaabbbaaaaabbabaabbabbaaaabbaabaaabaaabaabbbbabbbabaaabbaababbaabbabaabb\naaabbbbaabbbababababbabbabaaabbabaabaabb\naaabbbaabbbbababbbaababb\nbaabababbbbabbbabbaabbababbbaaabaaababbb\nbbbabaaaabaaaaabbbababab\nbaaaaabbbabbabbbbbaaaabaababbbbaabaabbabbbaaabbaababaaba\nabbaaaabaaabbaaababbabababbbaababbbbbbaabbbbbaaa\nbaabbbabaababaaaabbababa\naabbbabbabaaaaaabbbbbaba\naabbbbaaaaaaababbaabbbaababbabbbaaababbbabaabbbbbabbaaaa\naabbaabbbabaaaabbbabbaab\naabbaaaaabababbbabaaaaaabbbababbaababababbaabbabaaabaaaababbbbab\nbababbaaababaaaabbbbbbbb\naaaaababbbaaaabbbbaabbab\nbaabbaaaaabbbaaabaaababa\nbbbabbbabbaabaaabbbbaabbbbabbbaabbbaaaababbababbbaabababbaabaaab\nbbababababbababbbaaabbaaabbabababbbbbbaabaababaa\naababbaabaaaabbbabababaa\naaabbaaabbbaaaabbbbbaaaa\nbbabbabbabbaaaababbababa\nbbbabaaaaaabbaaaaabbabbbaaabbabaabbabaaa\naaaaaaaabbaababaaabbbbaabaabababbbbbbaab\nbabbaabaababaabaabababaabbbbbbba\naababaaaababbbbbbabbabababababaaabbbaaab\nbaabbbaabbbbbbbbabbaabbb\nbaababbbabbabbabaaaaaababaaabaaa\nababbbababbbbbabbaabbbaa\nbbaababaaabbbbaaababaaababbababa\nbbabbaaaabbabbbbaaabaaab\nabbbabbabbabaabaaaaaaabbabbbbbbbbbbbbaaa\nabbaaabbbbaaabbbbaababbbaaaabaab\nbbaabababaaabbbaabbaabbb\nababbabbaaabaabaaaaaaaabababaaababaaabbbaabbabaabbbbbaba\naababababaaaababbabaaaababaaabbbbaaaaaba\nbabaaabaabbbbbbbabbbbbbbbaababaabbaaabaa\nbababbbabaabbbabaaabbbaaaaabaababaabbbaabbbbbbba\nababbbabbbaaaabaabaabaaa\nababbbbaaabbaaabaababbbbaaaaaaaaabbababb\nbbaabaabaaaabbabaaaaaaabbabbaaaaabbbbbbb\naabaaabbababbbabaaaabaabbbaababb\nbabbbbabaaaabababaababbabaaaabbabbabaaabaaabbbbbbbaabbbb\nbabbaababbbbbbbabbabaabbbbabbaaaababaaaa\nbaabaabababbbbabbaaabaaaabbbaabaaabaabbabbbbabbbabaaaabababaaaabbbbbbabb\nbbbabaabaabbbabbbaabbaabaabaabba\nbabbbababbabbabbabbbaabaaaaabbbbbabaabbbabaaaabbbaaabaaa\naaabbbaababbbaaaaaabbbbaaaaaabbbaaaabbaaaababbbabbbabbba\nbabbaabbababbbbaaababbaabbaaaaaa\nabaababaabbbabaaaaabbaba\nabbabbabaabaaaaaaaabbaba\nbbbbbbaaababbbbaabbaaabbaababbbaaaababbb\nabbaaabbbbbbababaabaaaaaaaaaababbbbabbaa\nabbbabaaaabbaabbaaabababbbbbaaaa\nbbbababbaababbbbbbaaabbbbaabbababaaaaabb\nabbaababaabbbabbabababab\nababbaababaaabbbbababaaaaabababaaaabaabb\naaaaababbabbabaababbabba\naabbaababbaabaaaaaabbabababaaaaa\nbbabbabbaabaabbbbababaaabbbababbababaabb\nbabaaababbababbabbbbbbaabbbaaaaabbaaaabbbaaaaabb\naaabaabaaaaaabbbaaaabababaaabbbbbbbbabbbbaababababaabbbaabaaabaabbabbbba\nbaabababbabaaaabababaaabbaabbbba\nabaaaaaababbbaababbbbbba\nbaabbaaabaabbbabbbabbbaa\nababbbbbabaababaaabbabba\nabbaaabbbabbaaabbbbbbaaa\nababaaaaaabbaabbbbbaaaaaabaabbbabbbabaabbababbabbbbbaaababbbbaab\naabaaaaaaaaabaaabababbbaababaabaaaaabbababaabbababbaaaabbbabaaba\nbabaabababababbbaaabbbaaaabaaaabaaaabbbbaaababaaaababbaabaabaaabababaabb\nababbaabbbabbaababbababa\nababaaabbbaaabaabbbababbbaabaaabaabaaabb\naabbbabaaabaabababaaabbaaaabbabbaaababbb\nbaaabbabbbaaaababaaabaabbaaaabbbabbaaaabaaaabaabbaaabaaa\nbaaaababbaabbbbaaaaabbba\nbbababbaaabaababbbbbbaaa\nbbbaaabaabaaabbabaabaaaa\naabbbbaabaababbaaaabbaab\nababababbbbabbbaabbbbabbbaaababb\nabbaaabbbaaaabbabbbbbaba\naababbaaaaaaababbabbaaba\nabbaaabababbaabaaaaaaabaabbaabaabaabaaababaaaaba\nabaabbbababbbbaabbbbaabb\nabaaabbaaaaabbbbaaabaaaa\nbababbbbbaabbbbbbababbababbbbaba\nabbbabbbabbaaaabbabbbaaaaaabaabababbbbbaabaaabab\nababbbbbbabbbbabaaaaabba\nbaaabbabbaaaaaaaaabbbbaabbbbbaba\naabaaabbabbaabbabaabaaabbabbababaaabbaabaababaab\nabbbbabbaaabbaaaabbbbbaaababbbbbbbbaaabbbabbaaab\nababbaabbbbabaaaabaabbaa\nabababbababbabaabbaaaabaaaaaaabbaaaaaaabaababbababababbbaababbba\naaaaababbaababaaabbbaaababbbbaabbbbabbbaababbaaa\nbbaaaaabbabbaabbbbbbbbba\nababbabbabaaabbbaabababa\nbababbbaabbaaaaabbbbbaab\nabaaaaaabababaaabaabaabaaaaabaaa\nabaaabbaaababaaabbbbbabaababbbbbababaabababbbbbaabbbabbbabbaaabaababbaabbaabbabb\nababaaaabbaabaaaabbabbba\nbbbabaaabbbabaaaabaaaaabbababbaaabababbb\nbbabbabbbaaaaaabbbbbbbbb\nbbbbbbaabbaabaabaaabbabb\nbbbabaaabbabbabbaabbabba\naabaababaaaaaaaaaabbbabaabbbabbaabbbbaabbbbbaaaa\nabbaaabbaaabbbbaaababbab\nabaabababbbabaabbaaaabaaaaabbabbabaabaaa\nbabbbaaabaabbaabbbbaabbbabbbabbababbbababbbabbaa\naaaaaabbbbbaaababbaababb\nabbaaabbbbbbabbabbaabbab\nbbbbabbaabaababaaaaabababaaaabba\nbaaababbbbaaabaaaabababbbbaabbbbbbababab\nbabbbbababbbabbbaaabaaab\nbbaaabbbbbbaabaaaabbbbbbababbbabaaababbabbbbbaba\nbbabababbababbbabbbbbaabbaababbbbbaababaaabbabbababbaaaaababbbbabaaabaabbbbabbaaaabbbaba\nbbaabbbababbbbbbbaaabababbaaabaabbababbaabaaabaababbbaabbbbbbbba\nbaaaabababbaaaaabbabbbbabbbababb\naababbbbbabbaabbbbaaaaabaabbabbabaaababa\nbabbbbaaababbbabbbbbabababaaaaaaabbaaaba\nbabbaabbabbabbabaaabbbaabababaaababbabbaaababaabbabbabbb\nbbaabaabaabaabbbababaabb\naaaabbbababbababbabbabaaaaabbbbabbbababbbbbabbbbbaaaaabb\naabbbbaababbbbababbbbabbbaaabaaa\naaabbbbbabbbaaabbaababaa\nbabaaaabaabbbaaabbaabbaa\naaaaabbbaaabbbbabaaabbabbabbbababbabbbab\nbbbbaababaabababbabbabbb\nabbaababbbaaaababbbaaabaaabbabaa\nababbaabaaabbbabbaabaaab\nbaababbbabaaaaaaabbbabbabbabbabaaababbba\nbaaabbbaaabbbaaababbabaabbbbbaba\nbababbbbababbbbababaababbaabbbaabaaabbbbababaababbbbabbbbabaaababababbaababbbbaa\nabbaaaaabbbbbbababbbbaaa\nbbaabbababbbbaaaabaabababaaaabbababababbbbababbb\nabbbabbaabbaaabbaaabbaba\naaaabbbababbbbabaababaab\nbbaabbaaabaabbbababaaaabbbaabbbabbbabbab\nbabbbbbbbbababbaabaababb\nbbbbabbbaaabbbbbaaaabaabaababaababaabbbb\nbabbbabbaababbaabaaaaabb\nabbbabbbaabbbabbbbaaaaba\nbabababbaabbabbaaabbbbab\nbaaaabaaaaabaabaabbaaaba\nababbaaabbbabbbbabababbabbbbabbb\nbabaabababaaabbabababbaaaabaabaa\nbababbaaabbabbabaaababaa\nbaaaabaaaabbbbbbabbabbba\naabbaababaabbbabbabbbbbbbabbbabbaaaaabba\nabbaabbbabbbbbaabbaabbbbbbbbaababababbabababbaab\nababbbbbabaaaaabbbbaaababbbaabbbaaabaaaabaaaaababaabbbaa\nbabbababababaaaaaababbab\nbabaaabbabaaaaaabbbbaaaa\nbbbbaaaabbbabbbabaabaabbbbbabbab\nbababbaaabbbaababababaaaabbabbbbbbbaababbabbabba\nababbbababaaaaababbabaaa\nbbbbaababababaaaababaabb\nbaaaabbbaabababababbabba\naabbbabbaaabbbabbbaaaaabbbabbaabaaaaaaaabbaaaabaabbaabaa\naabaababaababbabbbbaababaabbbbabaaabbbbbaaabaaabbababbab\nabbabaabbbabbbaaabbaabba\naababaaaaababaaabbaaaabbabbbbbaaabababaa\nbaabbaababbbbaabbabbbaaaabbabaaaaaaabbbabbbaaabaaaabaaabbbaabbaaabbaabbbaabbabaaaaaabaab\nbabbbabbbaababbbabbabaaa\naaababababbbaabbabbabbba\nbabbbbbbaaabbaaabbbbbaab\nabbbaabbaaaaabbbbbabbbab\nbbaabababaabbbabbabababa\nbbabbbbabbbaaaabbaabaabaaabbbabbbbbababb\nabbabbabbbbbaabaababbbbbbbababbaabbbbbbaaabaaabbbbaabbba\nbababaabaababaaabbabbbbb\nbabbaabbbbaabaabbbaabbbabaabbaaabbbbaaabaabbabba\nbbabbaabababbbbabbbabaaa\nbaabbaabaaaaabaabbaaabab\naaabababbabbbaaabaaaabbaaaabbbaabaaaabbbabbbbbabaaaabaababbbbaab\nbaabbbabaabababaaaaabaabaaaaabaaaaaaabbaaabbbaabaabbbbaabaaaabba\nbbaabbaaaabbbaaaabaaabab\nbaaaaaaaaabbbababaaaaabbaabbbbbabbaaabab\naabbaabbabbbaaaabbbabbaaabaabbbbababbaba\nabaabbbaaaabbbaabbaaaabbbaabbbbb\nbbbbabbbaaabaabbaaaaabba\nbabbabaabaaababaabaabbabbbaaaaaa\nabbbbaababbbaabbabaaabbbbaaaaababaaabababbbbbaab\nbbaaaabbbbbbaaabbababaabaaabbbaababbbbabaaabbababbbababaaaaaabbbbbababba\nbaaaabbbbbbbabbabbaababb\nbbaaabbaabbbaaaabaabbaba\nabaaaaabbbbbaabaaababbbbbbbaaaab\naaaabbbaababaaabbbbbabbabbaaaabbaababababbbbbababaabbababbbbaaaabbbaaabb\nabaaabbbbbbaaaaabaabbbaa\naabaababbbabbbbaaaabbbaabbaaaaabaaabaabb\nbababaabbababaabbbaaabaa\nbaaaaaabbabaabbbbabaaabbbbabaabb\nbbabbbbbabbabbababbaaabbbabbababbaabbbbbbbbabbaa\naabbbbbaabbbabbabababbbaaabbbbbaaaabaaab\nbbbabaabaabbbabababbabaababbbbbababbaaaa\naaaabababaaababbbbbbbababbaabbbbbbbbaabbaababbbbaaababaaabbbaababaabbabbbbbbbbbb\naaaabaaabbabbabaabbbaaab\naaaabaabbbbaaaabbaaabaabbababababbbaabaaababbabaaabbabaa\nbbbabaaabaaaabbaabbbbaab\nabbabbbbbbabaaaababbbaabbaaaaababaabbabbbbbaababbabaaaaa\nabbabbaaaaaabababaaabbabaaaaabaabbbaabbaababaaba\naababbbabaababaaabbbaabbbbbbabaaaabbaababababbaaaaaaababbbbbbabbaababbbaaababbaabbbbabab\nabbaaaabbbaaaaabbaabbaaaaabbabbbbbbabaabaabbabbbbbbabbbaabbababb\nbaababbaababbabbbaabbaba\nbbababbaabbaababaaababbabbaaaaabbbabbabaabbbbababbabbbabababaaaa\naabbbbababababbaabaabbaababbbbba\nabaaaabbaaabbaaabbabbbaa\nabbaaabbabaabbbabababaabbbbaabba\nababaaababaaabbbabaaabaa\naabbaabaaabbbbaabaabaaab\naabaabbbabbaaaaaabbbbabaaabaabbaaaababbbaabbabbabbbbaaaaabbaabaa\nbaaabaabbaaaaaaabaaaaaabbababaaaabbbababbbbbaaaa\naababbbabbabaaabbababaaaabaabaaaabbbaaba\nabbabbbabbbabaaabbabababbbabaaaabbaaaaaaaaabababbbabbbab\nbbbabaaaaaaabbabababbaabaaaaabaaabaabbbabbbabbbabaababbbbbababbbaaaaabbb\nbaabababaaaaabbbbbbabbbb\nabbaaabbaaabaabaabaabaab\nabbbbbabbabaaababbabaabbbbabaaaaabbbbaabbaaabababaabaaaabababbbabbabbbaaabbaaabbababbabb\nababaaababaabbbabbbbaabb\nbbaababaabababbaabbbabbbbbabbabaabaabbaa\nbabaabbbababbbbabaaaababbbaaaabababababaabababab\nbbababbabbbbababaabbabaa\nbbaaaabababaababaaaabbbaabaaaaabbaabbbabbbbaabba\nbbabaababbbabaabaabaababababbbaabbbbbaabbbabbaba\nbbababbabbabaaabaaaabbbb\nbaababbbbbaabbaaabaabaaa\nabaaaaaaabbaaaababaabaabbbbbaabbbaaababb\nabaaaabbbabbabababbbbaaa\nabbbababaabbaabbbaaabbaabbbabbbbaabbbbbabbbbaabb\naabbaabbbbabbaaaaabbbbba\nbbbbabbaabaaaabbbaaababbabbababa\nbabbbabaaabaaaaaabbbbbabaabbabab\nbaaaaaababbbababbbbababa\nbaabbaabaabaaaaabaaabaabaaaabaabaabbbbba\naabaabbbbabbababaaabaabaaabaabaa\naabbaabbbabbabbbbababaababaaaaabbbaababaabbabbaabbabaaabbbabbaab\nbbabbaabbabaaabaabbbaabbbbbaaaaaaaaabbaaaabaabaa\nbabbaaabbabaabbbaababbba\naaaaabbbbbaaabbaabbabbaabababbbbaaababba\nbabbbaaaabaaabbabaaabbabbbabbaabbbababbb\nbabbbabbbabbbbaabababbaaabababbbbbaababbbbaabaaabbbbaabb\nbbabbbbbaabbbabbbabaabbbabababaa\nabbbabbabaaabbbbaaaabaaa\nbabbbbaabaaaaaababaabbbb\naaaababababbbaabbbbaabbbbabbaaabbbaaaaaa\nabbbaabbbababaaabaaaaabb\nbbaabbaabbaaabbabbaaabbaabaabaabbaaabbbb\nbababbababbabbbbabababbaaaabaabaaabaaababbaabaabbbabbabbaabbabbbaaaaaaababaaabba\nabbababaaaabaaabbaabbaba\nbaaababbbabaaabaaaaabaaaabaaaaababbbbbbbbabbabbbabbbabaabaababbabaaabbaaaaabaaabaabaaabababbbaab\nbbaaabbbabbabbaaabababab\naabababaabbabbbbbbababbaaaaabbbbabbbbbba\naaaaaabbaaabababaababaaabaaababb\nabbabaabbbbaaaaaabbaaaba\nabbbababaaabaababaaaaaaababaaaababababbbaabbbbba\nabbabbaababbbbababbaaaabbbbaabbbbabbbabbbabbabba\nbbbaabaaaaabbbaababbaabbbbbabaabbaaababaaaaababb\nbbaaaaababaabaaabaaabbaaabbaababbbbaaaabbbbbbaba\nbbaaaabbabbbbbbbaaaaaabbabbbbbabaababbaabaaabaabbbabaaabbaaabbbabbbabaabaaaabbaaaabaaabb\nabbabbaabbaaabbbbabbbbaabbaabaababaabaaaabbbaaababaabaabaaabaaab\nabbbabaaaabbaaabbbbabbaa\nbaabaaaabaaaabbaabaaaaab\naabbbabaabaaabbbbabbabba\nbbababbabbbaabbbbbbaaaabbaaabbabbbaabaaa\naaaabbbbbaaaababaabababababaabba\naabbbabababbbaaaaaabbbbaaaabaaaa\nabbaaaabbababbbaabbabbabababaababbbaaabb\nbaaaaaabbbabaaaaabbaabbb\naaaaaaabbbaaaabaabaaabaa\naabbbbbbbbabbaabababaaba\nbbbbbbaaaaabbaaaabbaabbb\nbbaaabbbbabaaabbbaaaabaaaabbaabababbbabbabaaaabaabababbb\nabbbbbabaabbbabbbbbababb\nabaababaabbbaabbabbbaababbababbbbbbbbbba\naabbbabaaaabbaaabbaabbaaabbbbaaa\naabbabbbaaaabbabababbaba\naaabbbbababbbaaababaabbbbaabbaba\naabbbababbabbaaaabbaaaaaaaaaaaaabbbaabbaaabababb\nababbbabbabaaababbaabbbb\naabbbabbbaabbbabababbabbabbbabbabaaabbbabaabbbbb\nabbbabbaaabbbababbabbbbbbbbbabaabaaaaabbabbbbababbbababb\nbaabaababaaaababbababbbb\nbbaaaaaabaabbbaaaaaabbbaaabbbbabbbaaabbbbbbbbbbbabbbbaaababaabaaaaaaaaabbbabaababaabaabb\naababbbbabaaababbbabbaaaaaaaaabbaabbbbbaaababababababaababbaabababababbbabbbababbbaabaab\nbbabaabaaabbbbbbbababbaa\naaababbabbbbababaababaabbbababaabbbabaababaaaabbaabbbaaa\nbbababbaaabbbaaaabbaabbb\naabbbabaababbbaabbbabaaaaaaabbbabbbbbbaaabbababaabbaaabaabaabbaa\nababbbaaaabaabbbbbbbbbbb\nabbbabaababbabaababaabba\naaabbbaababbabaabbbbaababbabbbab\nbbaaaababaaabbbabbaababbababbababaaabaaa\nbbaaabbaabbaababaaaaabbbbaabbbaaabbbbaaa\naaaaabababbbaaaabbbbbbabbabbbaababbabbaabbbbaabb\naaabbaaaabbbabaabbbbbabbbbaababbbbbbbbbabbaaaabaabbbabbbaaaabbabbbabbaaaaaaaabbbbbabaaba\nbabbbaabbaabaabaaaaabbbabbbbaabaaaabaabbbbabaabb\nabbabbabbabaaabaabbaabaa\nabaaaabbaaaaaaabbaaabbbabbaaabaa\nbbbbbbaababbababababbaba\nbbaaabbaabbbabbbabbaabba\nbabaabbbaabaababaabaabba\nababbbabbabbbaaabababbab\nbbaabbaaaaaaaaabbaabaaaa\nabbbbbabbbbabaaaaaabbbbabbbbbbbabaabbbaaaababbab\nbbbbaababaaabbabababaaba\nbabbabaababbaaabaababbaa\nbabbbaaaababaaababbbabaaabbbabaaabbbbbba\nbbbaabaababbababbbabaabb\naababbbbabbabbbbababbbabbbabbababbababab\nbaaaabbbbaaabbabbaabaabaaababbaaaaaaaabbbaabbbaaaabaaabb\naaaaaaaaababbbbbbbbaaaaabababaaabbbbbaaa\naaaaabababbabaabbabbabaaaaaabaab\nababbbabbabbbaabbaaababb\nabaaabbababaaaababbabbaaabaaabaa\nbabbabbbbabaaabbaabbbbaaabbbabaababbbbbbabaabbabaaabbbba\naaaaabbbabbabbbbbbaaaaaa\naaababbabbabaaabbabbabbb\nbabaabbbabbbabbbaabbbbbbbaabbaabaababbab\naaabbaabbaabbbbaaaaabbabbbaaaabbbaabababaaabbbabbababaaabbaababb\nbabbbbabababbabbbababbab\nbababbbbbaabaaabaabaaababbaabaabaaaaaaabbbababaaaaabaaba\naaaaaaaabaaaabbbbbaaabaa\nbbabbbbbaabaaaaaaaaaabaaabaabababbbbbbaaaaababbaaaababbb\naaabababaababbababbbbbaabbaabbba\nbaababababaaabbbbaaabbbb\nababbbabbaababbbbaaaaaababbbaabbaaaaabaabaabaaaa\nbabbaabbaabbaabbbaaaabbbababbbbbbabbbabbaaaababbbaaabaaaaababbaaaaababbbbbbbabbaaaababaa\naaaaaabbbbabaababbbaaababbababaa\nbabbbbaababbaabbabbbbaba\nbbaabbaaaaaabbbbabababbbbbabbbbbbaaabaaaabbabbbabbabbaaaaaaababa\nababbbaababbbaaaaabaabaa\nbaaaabbbbbbbabbaabbabaaa'.split(
        '\n\n')
    # (rules, input) = '0: 4 1 5\n1: 2 3 | 3 2\n2: 4 4 | 5 5\n3: 4 5 | 5 4\n4: "a"\n5: "b"\n\nababbb\nbababa\nabbbab\naaabbb\naaaabbb'.split('\n\n')
    # (rules, input) = '0: 1 2\n1: "a"\n2: 1 3 | 3 1\n3: "b"\n\naab\naba\nbab\nbba'.split('\n\n')

    rules = rules.split('\n')
    input = input.split('\n')

    ruls = {}
    for r in rules:
        (a, b) = r.split(': ')
        # print(r)
        if b[0] == '\"':
            # print('case 1')
            c = b[1:-1]
            ruls[a] = ([c])
        elif len(b.split(' ')) == 1:
            # print('case 2')
            ruls[a] = ([b])
        elif len(b.split(' | ')) == 1:
            # print('case 3')
            c = b.split(' ')
            ruls[a] = (c)
        else:
            # print('case 4')
            b = b.split(' | ')
            c1 = b[0].split(' ')
            c2 = b[1].split(' ')
            ruls[a] = (c1, c2)
    rules = ruls

    list = []
    list.append(rules['0'])
    listS = set([])

    i = 0
    while i < len(list):
        if i%10 == 0:
            print('\ri:{:10} l:{:10} %:{}'.format(i, len(list), 100.0*i/len(list)), end='')
        # print(list[i])
        rep = False
        for j,e in enumerate(list[i]):
            if 'a' <= e <= 'z':
                # print('c')
                continue
            tbr = rules[e]
            if type(tbr)==type((1,1)):
                # print('t')
                del list[i][j]
                list.append(list[i].copy())
                for k, a in enumerate(tbr[0]):
                    list[i].insert(j+k, a)
                for k, a in enumerate(tbr[1]):
                    list[-1].insert(j+k, a)
                rep = True
                break
            else:
                # print('l')
                del list[i][j]
                # print(list[i])
                for k, a in enumerate(tbr):
                    list[i].insert(j+k, a)
                    # print(list[i])
                rep = True
                break
        if rep:
            continue
        listS.add(''.join(list[i-1]))
        # print(len(listS))
        # time.sleep(0.1)
        i += 1
    print()

    count = 0
    for a in input:
        if a in listS:
            count += 1

    print('Part 1:', count)


def part2b():
    (rules,input) = '124: 72 26 | 58 91\n76: 72 90 | 58 73\n89: 58 135 | 72 25\n43: 58 30 | 72 98\n130: 58 58\n87: 135 72 | 100 58\n24: 72 5 | 58 78\n61: 84 72 | 71 58\n8: 42\n68: 49 72 | 91 58\n103: 126 58 | 124 72\n132: 58 17 | 72 37\n75: 72 89 | 58 50\n99: 72 72 | 58 58\n28: 58 19 | 72 65\n2: 9 72 | 67 58\n113: 58 100 | 72 130\n66: 129 58 | 70 72\n74: 72 116 | 58 56\n45: 72 82 | 58 38\n70: 137 58 | 12 72\n78: 72 58 | 58 58\n115: 78 58 | 27 72\n48: 58 121 | 72 95\n23: 120 58 | 93 72\n44: 58 25 | 72 130\n17: 58 27 | 72 91\n65: 102 72 | 46 58\n19: 72 84 | 58 35\n79: 29 72 | 127 58\n13: 58 88 | 72 136\n6: 15 72 | 130 58\n81: 58 72\n100: 117 72 | 58 58\n116: 78 72 | 49 58\n136: 20 72 | 50 58\n97: 53 72 | 85 58\n107: 58 27 | 72 5\n0: 8 11\n49: 58 72 | 72 117\n88: 105 58 | 21 72\n83: 69 72 | 5 58\n112: 58 32 | 72 2\n47: 62 72 | 118 58\n59: 58 134 | 72 101\n60: 132 72 | 103 58\n55: 58 44 | 72 92\n67: 72 15 | 58 100\n96: 81 72 | 135 58\n121: 25 58 | 26 72\n39: 58 81 | 72 25\n82: 81 58\n27: 72 72 | 117 58\n85: 58 119 | 72 68\n53: 72 39 | 58 80\n91: 72 58 | 72 72\n129: 58 133 | 72 3\n18: 58 69 | 72 25\n120: 110 58 | 36 72\n114: 58 87 | 72 16\n34: 72 40 | 58 45\n29: 58 123 | 72 59\n36: 15 117\n133: 58 107 | 72 113\n109: 58 58 | 58 72\n46: 100 117\n41: 109 58 | 91 72\n26: 72 72 | 58 72\n72: "a"\n21: 58 78 | 72 130\n117: 58 | 72\n111: 58 5 | 72 81\n95: 58 27 | 72 109\n4: 97 72 | 28 58\n135: 58 117 | 72 58\n37: 58 27\n1: 58 99 | 72 25\n52: 130 58 | 109 72\n106: 5 72 | 99 58\n12: 111 58 | 68 72\n42: 94 58 | 79 72\n11: 42 31\n77: 125 72 | 86 58\n98: 58 91 | 72 109\n62: 58 122 | 72 52\n119: 109 72 | 135 58\n108: 15 72 | 25 58\n10: 78 58 | 15 72\n5: 72 58\n3: 72 33 | 58 37\n57: 58 51 | 72 7\n7: 72 43 | 58 74\n38: 58 91 | 72 15\n20: 26 58 | 130 72\n22: 58 99 | 72 15\n105: 15 72 | 99 58\n25: 72 72\n35: 72 99 | 58 91\n56: 78 72 | 99 58\n63: 114 72 | 55 58\n86: 23 72 | 13 58\n54: 47 58 | 112 72\n50: 72 5 | 58 99\n126: 58 81 | 72 26\n127: 63 72 | 60 58\n9: 72 27 | 58 15\n137: 10 58 | 96 72\n15: 117 117\n128: 66 58 | 57 72\n58: "b"\n14: 18 72 | 116 58\n92: 58 25 | 72 100\n40: 83 58 | 131 72\n31: 77 58 | 128 72\n69: 58 72 | 72 58\n125: 34 58 | 76 72\n110: 117 99\n94: 72 4 | 58 54\n102: 72 25 | 58 109\n30: 58 91 | 72 5\n84: 99 117\n93: 50 72 | 6 58\n80: 72 100 | 58 91\n64: 58 5 | 72 130\n51: 58 61 | 72 48\n122: 5 58 | 25 72\n16: 58 130 | 72 78\n90: 22 58 | 106 72\n131: 58 91 | 72 130\n123: 14 72 | 75 58\n33: 58 15 | 72 26\n71: 27 72 | 69 58\n73: 104 58 | 24 72\n32: 72 126 | 58 41\n134: 72 1 | 58 35\n101: 72 84 | 58 115\n104: 130 58\n118: 64 58 | 108 72\n\nbaabababbaababbbaabbbbab\nbaabababbbabaabaabbbbbbb\nbbbabaaababbbbaaababbabbaabbabba\nbbbbbbaaaababbaaaababaaabbaaababaaababba\nbbabbaaaabbbabaaaabbbbbbabbbbbaa\naaaabaaabbbabbaaaabbbbbabaabbbaabbbaaaabbababbbb\nbbbabababbbbbbbbbbbbabbbababbaba\naabbbbaaabbabbabaaaababaabbbabbbbabbaaabaaaaabbbbaaababbabbbbbbabbbbaaababbbbaab\nbbababbaaabbbbbbabaaaabbbbbbabba\nbabaaaabbaaabbbabaaaaabb\nbbbabaaabaaabbbabababbaaabbbbbabababababaaaaaaba\nbbaabaabbbaaaabaabaaabaa\nbbaabababbaaabbbaaaaabaabababbbbbaaabbaa\nbabbbbaaaaaaaabbabbabbba\nbbbbbbabababbabbbbbbbbba\nbbaaababbaaabbbbaababbbababaaaabaabbbaaaabbbabbabaaabbab\nbbaaaabaaabbbaaabbaaabaa\nbaabbbaababbbbaaaaabbbbbbaaababbbbbbaaba\nabbabbbabaaaaaaabbabaaabaaabababbabaaabaaabbbaaa\naababaaababbbaabababbabbabbbabbbbaaaababaabbabab\nababbbbaaaaaaaabababaabb\nababbbaaaaaabbabbaaabbabbabbaabbaabaaaab\nbbaabaabaaabbaaabbbbbbbb\nbabaababbbbbbaaabbababba\nbbaabbaaaaaabbbbabbbabbbabaabbabababaaba\nbbbbbaaababbabaabbbaabbaaabbbbababbabaabaaaaaabaaabababaaaaaaaabaaaaababbbbbaabababbabbb\naabbbabababbaaabbbbaaaabbabbbbbbabaabaab\nabbbabbaabbbababbbababbabaabaaabbababbab\nbaaaabaaaaabbababbaaaaaabababbbbabbbbababaaaaaaaabbbabab\naabaabababbabbbbbaabbaabbbaabbba\naaaabbbbabbabbabbaabbaabbaaaababababaaaabaabaabbabbbbbaabaaaaaba\nbbbaaaabbaabbaababbabbbaabaababbbbaabbbbbbaabaaaabbbbaabaaaaabba\nbabbaabbaaaabbababaaabbabababbaaabbbababbbbbaabb\naabbbbaaabbbabbbabbababa\naaabaabaabbaaaabababaaabababbaabbabaaabbabaababaabbbaaab\naabbbabbbaababbbbbaaabaaaabaabaabaabaabbbaabbbaabbbaabba\nbbaabbaababbbaabaaaaaabbbbbbbbba\nababbabbabbbaabbabaababaaaaaaaaabbbaabaabbbabbba\nbbbabbabbabbbabbabbaaaaabbabbbabbbaaababababbabbbaaaaaaaaaababaaaabaabaaabbbababbbbaaaab\nbabaaaabababaaaabbabaaaababaababbabaabbabaabaaabaabbabba\naaabaabaabbbaabbbbbbabbababbabab\nbaababbbbabaabbaabbbaaaaabbabbbabbaabaabbababbaabbabbbbaabbbbbbb\nababbaababbabbbbbaababaaababbaba\nbaabbbabaaabbaababaaaabbbabbbaaaaaaaabaaaabbbbabababaabbabaaaabb\nbbbaaababbbbbbaabbbbabbb\nbbbaaaabaabaababaaabbaaaabbabbaaaaaaabbbaaabbabbbbabbaababbaaababaaabbaa\naabbbabaaaaaabbbabbabbba\naaaaaaabababbbabaabbbbba\naaaaaaaaababbbaababababbbbbabbbbabababaaabababaabbbbbaba\nbbaaaaabababaababbbaabbababbaaababbabababbababbaabbababbabaababaaabababbbbbbaaba\nbbaaaabbaaaaaaaababbaaaa\naaaaabaababaababaaababaa\nbabaabbbbaaabbbabbabbbbbbaaabbababaaabaababbaaaa\nbbbbbbaabababbaaaaabbbbabaabbaba\nabaaabbbaababbaaaababbbbbbaaaaababbabaaabbbaababaaababaa\nabbabbbabaaabaabaabbbabbbabbbabaababaaaaaaaaaaabbbbabaaaabbababbbaaaaaaababbabbbabbbbaab\naababbaaaaabaababbbaaabababbababbbbaabbbbabaabbbabaabbaa\nbbaabababbbbaababbaaabbabaaaaabbbabababa\naabbbabaabbbaabaaabbbabaabaababababbaaba\nbbabbaabbbbbbbbabbbbbaaaaabbaaabbbbabbbbbaaabbabbbbbbbbbbbbbbaababbaaabbaaaababbbbbbaaab\nabbbababbbaaaaaabbbabbabbbbabbabbbabaabb\naababbaaabbbaabbababbaaa\nabbabbbbbbbbaababaaabbbb\naaabbbaaaaabbbabbabbaaaa\nababbbbbabbabaabaaaaabaaabbabbaabbbbbaaa\naaaabbbabbbbababbbababbaabbbaabbaaababba\naaabbbabbbaabaababbbaaabbaaaababaabbabaababbabaa\nbaaaabaabaaabaabababaaba\nabbbabbbabbbabbaaaabbaab\nbbabbabbbaaaababbbaaabbaabbabbbbaabbbaaaabbbaabbaabbababababaaba\nabbabbaaaababababaabbbaa\nababbbaabaaabbbabbbabbab\nbbaaabbbbaaaaaababbbaababbabbbaabbaaaabb\nbbabbabbaabbababbaabbabaaaabaaaaabababaaaaabbaab\nbbaababaaaabbbaaaabbbbabbbabaabb\nbbababbaabaabbbababaababaabaaaab\nbababaaaaaaabbbabbbbaabaabbbabaababbbabbababaaba\nbabbaabbbbbbababbbabbbbbbaaaaaabbabbabaaaaabbabb\nbabbbabbabaaabbabbbbaaaa\naaaabbabbbababbabbaaaabaaaabbbaa\nabbbaabaaababaaaabbabbbbbbbaaaaabbabaabbababbaaabbbbbbbabaabaabb\nabbbabaaababaaaaaabaababbbababbaaabbabaabbbbaaabbbbbbaab\nbabbaabbbbbaababbaaabbbbabbaaaaa\nbabbbbbbbbbabaaabaabbbba\nbbbaaabaabaaaaabbaabbababbaabbabbabbababbabbbabaaabbabab\naabbbaaaababbaabbbabaaab\nbbbbbbaaababbbaabaababba\nbbabbbbbbbabaababbbabbba\nbabbabaababbbaaababbabababbbaabbbbaaabbbaaaabbababaababb\nababaaaaaaaaaaabbbaaaabbbaabbbbb\nabbbaaaaaaaaabbaababaabb\nbaabaabaaabbbabaabbabbabaabbbbba\nabaaabbbbbabbbbbbbbaabbbbbaaaabbbbbaabbbbbabbbababbaabaa\naaabbbaaababbbbabbbbabbabaabaabb\nabbabbbbbababaaababbabababbabbbbbaaaaaabbbaabaaaaabaaabb\nababbabbaabbaaabaaababbb\nbbbabaaaabaaaaabbaabbaabbbaababaaaaaababaaabaaabbbbbabaa\nbabbbababbbbbbabaaabaabababbbbbbbaaabbbb\naababaaaababbbaaababbbaababbbaaabbbaabbaaababbba\nababbbbaaabbbaaaaabaababaaaaaaaaabbababababbaaba\naabbaaababbabbaaaaabbbaa\nbbbbaaabbaabbababaabbbabbbabaaabbbabbabababaabab\nbabaababbbbbabababbabbbbbbbbaaaa\nabbbabaaabaaabbbaaabbbaaaaabbabaabbabbaaaabbaabaaabaaabaabbbbabbbabaaabbaababbaabbabaabb\naaabbbbaabbbababababbabbabaaabbabaabaabb\naaabbbaabbbbababbbaababb\nbaabababbbbabbbabbaabbababbbaaabaaababbb\nbbbabaaaabaaaaabbbababab\nbaaaaabbbabbabbbbbaaaabaababbbbaabaabbabbbaaabbaababaaba\nabbaaaabaaabbaaababbabababbbaababbbbbbaabbbbbaaa\nbaabbbabaababaaaabbababa\naabbbabbabaaaaaabbbbbaba\naabbbbaaaaaaababbaabbbaababbabbbaaababbbabaabbbbbabbaaaa\naabbaabbbabaaaabbbabbaab\naabbaaaaabababbbabaaaaaabbbababbaababababbaabbabaaabaaaababbbbab\nbababbaaababaaaabbbbbbbb\naaaaababbbaaaabbbbaabbab\nbaabbaaaaabbbaaabaaababa\nbbbabbbabbaabaaabbbbaabbbbabbbaabbbaaaababbababbbaabababbaabaaab\nbbababababbababbbaaabbaaabbabababbbbbbaabaababaa\naababbaabaaaabbbabababaa\naaabbaaabbbaaaabbbbbaaaa\nbbabbabbabbaaaababbababa\nbbbabaaaaaabbaaaaabbabbbaaabbabaabbabaaa\naaaaaaaabbaababaaabbbbaabaabababbbbbbaab\nbabbaabaababaabaabababaabbbbbbba\naababaaaababbbbbbabbabababababaaabbbaaab\nbaabbbaabbbbbbbbabbaabbb\nbaababbbabbabbabaaaaaababaaabaaa\nababbbababbbbbabbaabbbaa\nbbaababaaabbbbaaababaaababbababa\nbbabbaaaabbabbbbaaabaaab\nabbbabbabbabaabaaaaaaabbabbbbbbbbbbbbaaa\nabbaaabbbbaaabbbbaababbbaaaabaab\nbbaabababaaabbbaabbaabbb\nababbabbaaabaabaaaaaaaabababaaababaaabbbaabbabaabbbbbaba\naababababaaaababbabaaaababaaabbbbaaaaaba\nbabaaabaabbbbbbbabbbbbbbbaababaabbaaabaa\nbababbbabaabbbabaaabbbaaaaabaababaabbbaabbbbbbba\nababbbabbbaaaabaabaabaaa\nababbbbaaabbaaabaababbbbaaaaaaaaabbababb\nbbaabaabaaaabbabaaaaaaabbabbaaaaabbbbbbb\naabaaabbababbbabaaaabaabbbaababb\nbabbbbabaaaabababaababbabaaaabbabbabaaabaaabbbbbbbaabbbb\nbabbaababbbbbbbabbabaabbbbabbaaaababaaaa\nbaabaabababbbbabbaaabaaaabbbaabaaabaabbabbbbabbbabaaaabababaaaabbbbbbabb\nbbbabaabaabbbabbbaabbaabaabaabba\nbabbbababbabbabbabbbaabaaaaabbbbbabaabbbabaaaabbbaaabaaa\naaabbbaababbbaaaaaabbbbaaaaaabbbaaaabbaaaababbbabbbabbba\nbabbaabbababbbbaaababbaabbaaaaaa\nabaababaabbbabaaaaabbaba\nabbabbabaabaaaaaaaabbaba\nbbbbbbaaababbbbaabbaaabbaababbbaaaababbb\nabbaaabbbbbbababaabaaaaaaaaaababbbbabbaa\nabbbabaaaabbaabbaaabababbbbbaaaa\nbbbababbaababbbbbbaaabbbbaabbababaaaaabb\nabbaababaabbbabbabababab\nababbaababaaabbbbababaaaaabababaaaabaabb\naaaaababbabbabaababbabba\naabbaababbaabaaaaaabbabababaaaaa\nbbabbabbaabaabbbbababaaabbbababbababaabb\nbabaaababbababbabbbbbbaabbbaaaaabbaaaabbbaaaaabb\naaabaabaaaaaabbbaaaabababaaabbbbbbbbabbbbaababababaabbbaabaaabaabbabbbba\nbaabababbabaaaabababaaabbaabbbba\nabaaaaaababbbaababbbbbba\nbaabbaaabaabbbabbbabbbaa\nababbbbbabaababaaabbabba\nabbaaabbbabbaaabbbbbbaaa\nababaaaaaabbaabbbbbaaaaaabaabbbabbbabaabbababbabbbbbaaababbbbaab\naabaaaaaaaaabaaabababbbaababaabaaaaabbababaabbababbaaaabbbabaaba\nbabaabababababbbaaabbbaaaabaaaabaaaabbbbaaababaaaababbaabaabaaabababaabb\nababbaabbbabbaababbababa\nababaaabbbaaabaabbbababbbaabaaabaabaaabb\naabbbabaaabaabababaaabbaaaabbabbaaababbb\nbaaabbabbbaaaababaaabaabbaaaabbbabbaaaabaaaabaabbaaabaaa\nbaaaababbaabbbbaaaaabbba\nbbababbaaabaababbbbbbaaa\nbbbaaabaabaaabbabaabaaaa\naabbbbaabaababbaaaabbaab\nababababbbbabbbaabbbbabbbaaababb\nabbaaabbbaaaabbabbbbbaba\naababbaaaaaaababbabbaaba\nabbaaabababbaabaaaaaaabaabbaabaabaabaaababaaaaba\nabaabbbababbbbaabbbbaabb\nabaaabbaaaaabbbbaaabaaaa\nbababbbbbaabbbbbbababbababbbbaba\nabbbabbbabbaaaabbabbbaaaaaabaabababbbbbaabaaabab\nababbbbbbabbbbabaaaaabba\nbaaabbabbaaaaaaaaabbbbaabbbbbaba\naabaaabbabbaabbabaabaaabbabbababaaabbaabaababaab\nabbbbabbaaabbaaaabbbbbaaababbbbbbbbaaabbbabbaaab\nababbaabbbbabaaaabaabbaa\nabababbababbabaabbaaaabaaaaaaabbaaaaaaabaababbababababbbaababbba\naaaaababbaababaaabbbaaababbbbaabbbbabbbaababbaaa\nbbaaaaabbabbaabbbbbbbbba\nababbabbabaaabbbaabababa\nbababbbaabbaaaaabbbbbaab\nabaaaaaabababaaabaabaabaaaaabaaa\nabaaabbaaababaaabbbbbabaababbbbbababaabababbbbbaabbbabbbabbaaabaababbaabbaabbabb\nababaaaabbaabaaaabbabbba\nbbbabaaabbbabaaaabaaaaabbababbaaabababbb\nbbabbabbbaaaaaabbbbbbbbb\nbbbbbbaabbaabaabaaabbabb\nbbbabaaabbabbabbaabbabba\naabaababaaaaaaaaaabbbabaabbbabbaabbbbaabbbbbaaaa\nabbaaabbaaabbbbaaababbab\nabaabababbbabaabbaaaabaaaaabbabbabaabaaa\nbabbbaaabaabbaabbbbaabbbabbbabbababbbababbbabbaa\naaaaaabbbbbaaababbaababb\nabbaaabbbbbbabbabbaabbab\nbbbbabbaabaababaaaaabababaaaabba\nbaaababbbbaaabaaaabababbbbaabbbbbbababab\nbabbbbababbbabbbaaabaaab\nbbaaabbbbbbaabaaaabbbbbbababbbabaaababbabbbbbaba\nbbabababbababbbabbbbbaabbaababbbbbaababaaabbabbababbaaaaababbbbabaaabaabbbbabbaaaabbbaba\nbbaabbbababbbbbbbaaabababbaaabaabbababbaabaaabaababbbaabbbbbbbba\nbaaaabababbaaaaabbabbbbabbbababb\naababbbbbabbaabbbbaaaaabaabbabbabaaababa\nbabbbbaaababbbabbbbbabababaaaaaaabbaaaba\nbabbaabbabbabbabaaabbbaabababaaababbabbaaababaabbabbabbb\nbbaabaabaabaabbbababaabb\naaaabbbababbababbabbabaaaaabbbbabbbababbbbbabbbbbaaaaabb\naabbbbaababbbbababbbbabbbaaabaaa\naaabbbbbabbbaaabbaababaa\nbabaaaabaabbbaaabbaabbaa\naaaaabbbaaabbbbabaaabbabbabbbababbabbbab\nbbbbaababaabababbabbabbb\nabbaababbbaaaababbbaaabaaabbabaa\nababbaabaaabbbabbaabaaab\nbaababbbabaaaaaaabbbabbabbabbabaaababbba\nbaaabbbaaabbbaaababbabaabbbbbaba\nbababbbbababbbbababaababbaabbbaabaaabbbbababaababbbbabbbbabaaababababbaababbbbaa\nabbaaaaabbbbbbababbbbaaa\nbbaabbababbbbaaaabaabababaaaabbababababbbbababbb\nabbbabbaabbaaabbaaabbaba\naaaabbbababbbbabaababaab\nbbaabbaaabaabbbababaaaabbbaabbbabbbabbab\nbabbbbbbbbababbaabaababb\nbbbbabbbaaabbbbbaaaabaabaababaababaabbbb\nbabbbabbaababbaabaaaaabb\nabbbabbbaabbbabbbbaaaaba\nbabababbaabbabbaaabbbbab\nbaaaabaaaaabaabaabbaaaba\nababbaaabbbabbbbabababbabbbbabbb\nbabaabababaaabbabababbaaaabaabaa\nbababbaaabbabbabaaababaa\nbaaaabaaaabbbbbbabbabbba\naabbaababaabbbabbabbbbbbbabbbabbaaaaabba\nabbaabbbabbbbbaabbaabbbbbbbbaababababbabababbaab\nababbbbbabaaaaabbbbaaababbbaabbbaaabaaaabaaaaababaabbbaa\nbabbababababaaaaaababbab\nbabaaabbabaaaaaabbbbaaaa\nbbbbaaaabbbabbbabaabaabbbbbabbab\nbababbaaabbbaababababaaaabbabbbbbbbaababbabbabba\nababbbababaaaaababbabaaa\nbbbbaababababaaaababaabb\nbaaaabbbaabababababbabba\naabbbabbaaabbbabbbaaaaabbbabbaabaaaaaaaabbaaaabaabbaabaa\naabaababaababbabbbbaababaabbbbabaaabbbbbaaabaaabbababbab\nabbabaabbbabbbaaabbaabba\naababaaaaababaaabbaaaabbabbbbbaaabababaa\nbaabbaababbbbaabbabbbaaaabbabaaaaaaabbbabbbaaabaaaabaaabbbaabbaaabbaabbbaabbabaaaaaabaab\nbabbbabbbaababbbabbabaaa\naaababababbbaabbabbabbba\nbabbbbbbaaabbaaabbbbbaab\nabbbaabbaaaaabbbbbabbbab\nbbaabababaabbbabbabababa\nbbabbbbabbbaaaabbaabaabaaabbbabbbbbababb\nabbabbabbbbbaabaababbbbbbbababbaabbbbbbaaabaaabbbbaabbba\nbababaabaababaaabbabbbbb\nbabbaabbbbaabaabbbaabbbabaabbaaabbbbaaabaabbabba\nbbabbaabababbbbabbbabaaa\nbaabbaabaaaaabaabbaaabab\naaabababbabbbaaabaaaabbaaaabbbaabaaaabbbabbbbbabaaaabaababbbbaab\nbaabbbabaabababaaaaabaabaaaaabaaaaaaabbaaabbbaabaabbbbaabaaaabba\nbbaabbaaaabbbaaaabaaabab\nbaaaaaaaaabbbababaaaaabbaabbbbbabbaaabab\naabbaabbabbbaaaabbbabbaaabaabbbbababbaba\nabaabbbaaaabbbaabbaaaabbbaabbbbb\nbbbbabbbaaabaabbaaaaabba\nbabbabaabaaababaabaabbabbbaaaaaa\nabbbbaababbbaabbabaaabbbbaaaaababaaabababbbbbaab\nbbaaaabbbbbbaaabbababaabaaabbbaababbbbabaaabbababbbababaaaaaabbbbbababba\nbaaaabbbbbbbabbabbaababb\nbbaaabbaabbbaaaabaabbaba\nabaaaaabbbbbaabaaababbbbbbbaaaab\naaaabbbaababaaabbbbbabbabbaaaabbaababababbbbbababaabbababbbbaaaabbbaaabb\nabaaabbbbbbaaaaabaabbbaa\naabaababbbabbbbaaaabbbaabbaaaaabaaabaabb\nbababaabbababaabbbaaabaa\nbaaaaaabbabaabbbbabaaabbbbabaabb\nbbabbbbbabbabbababbaaabbbabbababbaabbbbbbbbabbaa\naabbbbbaabbbabbabababbbaaabbbbbaaaabaaab\nbbbabaabaabbbabababbabaababbbbbababbaaaa\naaaabababaaababbbbbbbababbaabbbbbbbbaabbaababbbbaaababaaabbbaababaabbabbbbbbbbbb\naaaabaaabbabbabaabbbaaab\naaaabaabbbbaaaabbaaabaabbababababbbaabaaababbabaaabbabaa\nbbbabaaabaaaabbaabbbbaab\nabbabbbbbbabaaaababbbaabbaaaaababaabbabbbbbaababbabaaaaa\nabbabbaaaaaabababaaabbabaaaaabaabbbaabbaababaaba\naababbbabaababaaabbbaabbbbbbabaaaabbaababababbaaaaaaababbbbbbabbaababbbaaababbaabbbbabab\nabbaaaabbbaaaaabbaabbaaaaabbabbbbbbabaabaabbabbbbbbabbbaabbababb\nbaababbaababbabbbaabbaba\nbbababbaabbaababaaababbabbaaaaabbbabbabaabbbbababbabbbabababaaaa\naabbbbababababbaabaabbaababbbbba\nabaaaabbaaabbaaabbabbbaa\nabbaaabbabaabbbabababaabbbbaabba\nababaaababaaabbbabaaabaa\naabbaabaaabbbbaabaabaaab\naabaabbbabbaaaaaabbbbabaaabaabbaaaababbbaabbabbabbbbaaaaabbaabaa\nbaaabaabbaaaaaaabaaaaaabbababaaaabbbababbbbbaaaa\naababbbabbabaaabbababaaaabaabaaaabbbaaba\nabbabbbabbbabaaabbabababbbabaaaabbaaaaaaaaabababbbabbbab\nbbbabaaaaaaabbabababbaabaaaaabaaabaabbbabbbabbbabaababbbbbababbbaaaaabbb\nbaabababaaaaabbbbbbabbbb\nabbaaabbaaabaabaabaabaab\nabbbbbabbabaaababbabaabbbbabaaaaabbbbaabbaaabababaabaaaabababbbabbabbbaaabbaaabbababbabb\nababaaababaabbbabbbbaabb\nbbaababaabababbaabbbabbbbbabbabaabaabbaa\nbabaabbbababbbbabaaaababbbaaaabababababaabababab\nbbababbabbbbababaabbabaa\nbbaaaabababaababaaaabbbaabaaaaabbaabbbabbbbaabba\nbbabaababbbabaabaabaababababbbaabbbbbaabbbabbaba\nbbababbabbabaaabaaaabbbb\nbaababbbbbaabbaaabaabaaa\nabaaaaaaabbaaaababaabaabbbbbaabbbaaababb\nabaaaabbbabbabababbbbaaa\nabbbababaabbaabbbaaabbaabbbabbbbaabbbbbabbbbaabb\naabbaabbbbabbaaaaabbbbba\nbbbbabbaabaaaabbbaaababbabbababa\nbabbbabaaabaaaaaabbbbbabaabbabab\nbaaaaaababbbababbbbababa\nbaabbaabaabaaaaabaaabaabaaaabaabaabbbbba\naabaabbbbabbababaaabaabaaabaabaa\naabbaabbbabbabbbbababaababaaaaabbbaababaabbabbaabbabaaabbbabbaab\nbbabbaabbabaaabaabbbaabbbbbaaaaaaaaabbaaaabaabaa\nbabbaaabbabaabbbaababbba\naaaaabbbbbaaabbaabbabbaabababbbbaaababba\nbabbbaaaabaaabbabaaabbabbbabbaabbbababbb\nbabbbabbbabbbbaabababbaaabababbbbbaababbbbaabaaabbbbaabb\nbbabbbbbaabbbabbbabaabbbabababaa\nabbbabbabaaabbbbaaaabaaa\nbabbbbaabaaaaaababaabbbb\naaaababababbbaabbbbaabbbbabbaaabbbaaaaaa\nabbbaabbbababaaabaaaaabb\nbbaabbaabbaaabbabbaaabbaabaabaabbaaabbbb\nbababbababbabbbbabababbaaaabaabaaabaaababbaabaabbbabbabbaabbabbbaaaaaaababaaabba\nabbababaaaabaaabbaabbaba\nbaaababbbabaaabaaaaabaaaabaaaaababbbbbbbbabbabbbabbbabaabaababbabaaabbaaaaabaaabaabaaabababbbaab\nbbaaabbbabbabbaaabababab\naabababaabbabbbbbbababbaaaaabbbbabbbbbba\naaaaaabbaaabababaababaaabaaababb\nabbabaabbbbaaaaaabbaaaba\nabbbababaaabaababaaaaaaababaaaababababbbaabbbbba\nabbabbaababbbbababbaaaabbbbaabbbbabbbabbbabbabba\nbbbaabaaaaabbbaababbaabbbbbabaabbaaababaaaaababb\nbbaaaaababaabaaabaaabbaaabbaababbbbaaaabbbbbbaba\nbbaaaabbabbbbbbbaaaaaabbabbbbbabaababbaabaaabaabbbabaaabbaaabbbabbbabaabaaaabbaaaabaaabb\nabbabbaabbaaabbbbabbbbaabbaabaababaabaaaabbbaaababaabaabaaabaaab\nabbbabaaaabbaaabbbbabbaa\nbaabaaaabaaaabbaabaaaaab\naabbbabaabaaabbbbabbabba\nbbababbabbbaabbbbbbaaaabbaaabbabbbaabaaa\naaaabbbbbaaaababaabababababaabba\naabbbabababbbaaaaaabbbbaaaabaaaa\nabbaaaabbababbbaabbabbabababaababbbaaabb\nbaaaaaabbbabaaaaabbaabbb\naaaaaaabbbaaaabaabaaabaa\naabbbbbbbbabbaabababaaba\nbbbbbbaaaaabbaaaabbaabbb\nbbaaabbbbabaaabbbaaaabaaaabbaabababbbabbabaaaabaabababbb\nabbbbbabaabbbabbbbbababb\nabaababaabbbaabbabbbaababbababbbbbbbbbba\naabbbabaaaabbaaabbaabbaaabbbbaaa\naabbabbbaaaabbabababbaba\naaabbbbababbbaaababaabbbbaabbaba\naabbbababbabbaaaabbaaaaaaaaaaaaabbbaabbaaabababb\nababbbabbabaaababbaabbbb\naabbbabbbaabbbabababbabbabbbabbabaaabbbabaabbbbb\nabbbabbaaabbbababbabbbbbbbbbabaabaaaaabbabbbbababbbababb\nbaabaababaaaababbababbbb\nbbaaaaaabaabbbaaaaaabbbaaabbbbabbbaaabbbbbbbbbbbabbbbaaababaabaaaaaaaaabbbabaababaabaabb\naababbbbabaaababbbabbaaaaaaaaabbaabbbbbaaababababababaababbaabababababbbabbbababbbaabaab\nbbabaabaaabbbbbbbababbaa\naaababbabbbbababaababaabbbababaabbbabaababaaaabbaabbbaaa\nbbababbaaabbbaaaabbaabbb\naabbbabaababbbaabbbabaaaaaaabbbabbbbbbaaabbababaabbaaabaabaabbaa\nababbbaaaabaabbbbbbbbbbb\nabbbabaababbabaababaabba\naaabbbaababbabaabbbbaababbabbbab\nbbaaaababaaabbbabbaababbababbababaaabaaa\nbbaaabbaabbaababaaaaabbbbaabbbaaabbbbaaa\naaaaabababbbaaaabbbbbbabbabbbaababbabbaabbbbaabb\naaabbaaaabbbabaabbbbbabbbbaababbbbbbbbbabbaaaabaabbbabbbaaaabbabbbabbaaaaaaaabbbbbabaaba\nbabbbaabbaabaabaaaaabbbabbbbaabaaaabaabbbbabaabb\nabbabbabbabaaabaabbaabaa\nabaaaabbaaaaaaabbaaabbbabbaaabaa\nbbbbbbaababbababababbaba\nbbaaabbaabbbabbbabbaabba\nbabaabbbaabaababaabaabba\nababbbabbabbbaaabababbab\nbbaabbaaaaaaaaabbaabaaaa\nabbbbbabbbbabaaaaaabbbbabbbbbbbabaabbbaaaababbab\nbbbbaababaaabbabababaaba\nbabbabaababbaaabaababbaa\nbabbbaaaababaaababbbabaaabbbabaaabbbbbba\nbbbaabaababbababbbabaabb\naababbbbabbabbbbababbbabbbabbababbababab\nbaaaabbbbaaabbabbaabaabaaababbaaaaaaaabbbaabbbaaaabaaabb\naaaaaaaaababbbbbbbbaaaaabababaaabbbbbaaa\naaaaabababbabaabbabbabaaaaaabaab\nababbbabbabbbaabbaaababb\nabaaabbababaaaababbabbaaabaaabaa\nbabbabbbbabaaabbaabbbbaaabbbabaababbbbbbabaabbabaaabbbba\naaaaabbbabbabbbbbbaaaaaa\naaababbabbabaaabbabbabbb\nbabaabbbabbbabbbaabbbbbbbaabbaabaababbab\naaabbaabbaabbbbaaaaabbabbbaaaabbbaabababaaabbbabbababaaabbaababb\nbabbbbabababbabbbababbab\nbababbbbbaabaaabaabaaababbaabaabaaaaaaabbbababaaaaabaaba\naaaaaaaabaaaabbbbbaaabaa\nbbabbbbbaabaaaaaaaaaabaaabaabababbbbbbaaaaababbaaaababbb\naaabababaababbababbbbbaabbaabbba\nbaababababaaabbbbaaabbbb\nababbbabbaababbbbaaaaaababbbaabbaaaaabaabaabaaaa\nbabbaabbaabbaabbbaaaabbbababbbbbbabbbabbaaaababbbaaabaaaaababbaaaaababbbbbbbabbaaaababaa\naaaaaabbbbabaababbbaaababbababaa\nbabbbbaababbaabbabbbbaba\nbbaabbaaaaaabbbbabababbbbbabbbbbbaaabaaaabbabbbabbabbaaaaaaababa\nababbbaababbbaaaaabaabaa\nbaaaabbbbbbbabbaabbabaaa'.split(
        '\n\n')
    # (rules, input) = '0: 4 1 5\n1: 2 3 | 3 2\n2: 4 4 | 5 5\n3: 4 5 | 5 4\n4: "a"\n5: "b"\n\nababbb\nbababa\nabbbab\naaabbb\naaaabbb'.split('\n\n')
    # (rules, input) = '0: 1 2\n1: "a"\n2: 1 3 | 3 1\n3: "b"\n\naab\naba\nbab\nbba'.split('\n\n')

    rules = rules.split('\n')
    input = input.split('\n')

    ruls = {}
    for r in rules:
        (a, b) = r.split(': ')
        # print(r)
        if b[0] == '\"':
            # print('case 1')
            c = b[1:-1]
            ruls[a] = ([c])
        elif len(b.split(' ')) == 1:
            # print('case 2')
            ruls[a] = ([b])
        elif len(b.split(' | ')) == 1:
            # print('case 3')
            c = b.split(' ')
            ruls[a] = (c)
        else:
            # print('case 4')
            b = b.split(' | ')
            c1 = b[0].split(' ')
            c2 = b[1].split(' ')
            ruls[a] = (c1, c2)
    rules = ruls

    list = []
    list.append(rules['0'])
    listS = set([])

    max = 0
    for i in input:
        if max < len(i):
            max = len(i)

    i = 0
    while i < len(list):
        # if i%10 == 0:
        #     print('\ri:{:10} l:{:10} %:{}'.format(i, len(list), 100.0*i/len(list)), end='')
        print(''.join(list[i]))
        rep = False
        if max < len(list[i]):
            del list[i]
            continue
        for j,e in enumerate(list[i]):
            if 'a' <= e <= 'z':
                # print('c')
                continue
            tbr = rules[e]
            if e == '8':
                del list[i][j]
                list[i].insert(j, '42')
                list.append(list[i].copy())
                list[-1].insert(j, '42')
                while len(list[-1])<100:
                    list.append(list[-1].copy())
                    list[-1].insert(j, '42')
                rep = True
                break
            elif e == '11':
                del list[i][j]
                list[i].insert(j, '42')
                list[i].insert(j+1, '31')
                list.append(list[i].copy())
                k=1
                list[-1].insert(j+k, '42')
                list[-1].insert(j+k+1, '31')
                while len(list[-1])<100:
                    k += 1
                    list.append(list[-1].copy())
                    list[-1].insert(j+k, '42')
                    list[-1].insert(j+k+1, '31')
                rep = True
                break
            elif type(tbr)==type((1,1)):
                # print('t')
                del list[i][j]
                list.append(list[i].copy())
                for k, a in enumerate(tbr[0]):
                    list[i].insert(j+k, a)
                for k, a in enumerate(tbr[1]):
                    list[-1].insert(j+k, a)
                rep = True
                break
            else:
                # print('l')
                del list[i][j]
                # print(list[i])
                for k, a in enumerate(tbr):
                    list[i].insert(j+k, a)
                    # print(list[i])
                rep = True
                break
        if rep:
            continue
        listS.add(''.join(list[i-1]))
        # print(len(listS))
        # time.sleep(0.1)
        i += 1
    print()

    count = 0
    for a in input:
        if a in listS:
            count += 1

    print('Part 2:', count)


def part2():

    (rules,input) = '124: 72 26 | 58 91\n76: 72 90 | 58 73\n89: 58 135 | 72 25\n43: 58 30 | 72 98\n130: 58 58\n87: 135 72 | 100 58\n24: 72 5 | 58 78\n61: 84 72 | 71 58\n8: 42\n68: 49 72 | 91 58\n103: 126 58 | 124 72\n132: 58 17 | 72 37\n75: 72 89 | 58 50\n99: 72 72 | 58 58\n28: 58 19 | 72 65\n2: 9 72 | 67 58\n113: 58 100 | 72 130\n66: 129 58 | 70 72\n74: 72 116 | 58 56\n45: 72 82 | 58 38\n70: 137 58 | 12 72\n78: 72 58 | 58 58\n115: 78 58 | 27 72\n48: 58 121 | 72 95\n23: 120 58 | 93 72\n44: 58 25 | 72 130\n17: 58 27 | 72 91\n65: 102 72 | 46 58\n19: 72 84 | 58 35\n79: 29 72 | 127 58\n13: 58 88 | 72 136\n6: 15 72 | 130 58\n81: 58 72\n100: 117 72 | 58 58\n116: 78 72 | 49 58\n136: 20 72 | 50 58\n97: 53 72 | 85 58\n107: 58 27 | 72 5\n0: 8 11\n49: 58 72 | 72 117\n88: 105 58 | 21 72\n83: 69 72 | 5 58\n112: 58 32 | 72 2\n47: 62 72 | 118 58\n59: 58 134 | 72 101\n60: 132 72 | 103 58\n55: 58 44 | 72 92\n67: 72 15 | 58 100\n96: 81 72 | 135 58\n121: 25 58 | 26 72\n39: 58 81 | 72 25\n82: 81 58\n27: 72 72 | 117 58\n85: 58 119 | 72 68\n53: 72 39 | 58 80\n91: 72 58 | 72 72\n129: 58 133 | 72 3\n18: 58 69 | 72 25\n120: 110 58 | 36 72\n114: 58 87 | 72 16\n34: 72 40 | 58 45\n29: 58 123 | 72 59\n36: 15 117\n133: 58 107 | 72 113\n109: 58 58 | 58 72\n46: 100 117\n41: 109 58 | 91 72\n26: 72 72 | 58 72\n72: "a"\n21: 58 78 | 72 130\n117: 58 | 72\n111: 58 5 | 72 81\n95: 58 27 | 72 109\n4: 97 72 | 28 58\n135: 58 117 | 72 58\n37: 58 27\n1: 58 99 | 72 25\n52: 130 58 | 109 72\n106: 5 72 | 99 58\n12: 111 58 | 68 72\n42: 94 58 | 79 72\n11: 42 31\n77: 125 72 | 86 58\n98: 58 91 | 72 109\n62: 58 122 | 72 52\n119: 109 72 | 135 58\n108: 15 72 | 25 58\n10: 78 58 | 15 72\n5: 72 58\n3: 72 33 | 58 37\n57: 58 51 | 72 7\n7: 72 43 | 58 74\n38: 58 91 | 72 15\n20: 26 58 | 130 72\n22: 58 99 | 72 15\n105: 15 72 | 99 58\n25: 72 72\n35: 72 99 | 58 91\n56: 78 72 | 99 58\n63: 114 72 | 55 58\n86: 23 72 | 13 58\n54: 47 58 | 112 72\n50: 72 5 | 58 99\n126: 58 81 | 72 26\n127: 63 72 | 60 58\n9: 72 27 | 58 15\n137: 10 58 | 96 72\n15: 117 117\n128: 66 58 | 57 72\n58: "b"\n14: 18 72 | 116 58\n92: 58 25 | 72 100\n40: 83 58 | 131 72\n31: 77 58 | 128 72\n69: 58 72 | 72 58\n125: 34 58 | 76 72\n110: 117 99\n94: 72 4 | 58 54\n102: 72 25 | 58 109\n30: 58 91 | 72 5\n84: 99 117\n93: 50 72 | 6 58\n80: 72 100 | 58 91\n64: 58 5 | 72 130\n51: 58 61 | 72 48\n122: 5 58 | 25 72\n16: 58 130 | 72 78\n90: 22 58 | 106 72\n131: 58 91 | 72 130\n123: 14 72 | 75 58\n33: 58 15 | 72 26\n71: 27 72 | 69 58\n73: 104 58 | 24 72\n32: 72 126 | 58 41\n134: 72 1 | 58 35\n101: 72 84 | 58 115\n104: 130 58\n118: 64 58 | 108 72\n\nbaabababbaababbbaabbbbab\nbaabababbbabaabaabbbbbbb\nbbbabaaababbbbaaababbabbaabbabba\nbbbbbbaaaababbaaaababaaabbaaababaaababba\nbbabbaaaabbbabaaaabbbbbbabbbbbaa\naaaabaaabbbabbaaaabbbbbabaabbbaabbbaaaabbababbbb\nbbbabababbbbbbbbbbbbabbbababbaba\naabbbbaaabbabbabaaaababaabbbabbbbabbaaabaaaaabbbbaaababbabbbbbbabbbbaaababbbbaab\nbbababbaaabbbbbbabaaaabbbbbbabba\nbabaaaabbaaabbbabaaaaabb\nbbbabaaabaaabbbabababbaaabbbbbabababababaaaaaaba\nbbaabaabbbaaaabaabaaabaa\nbbaabababbaaabbbaaaaabaabababbbbbaaabbaa\nbabbbbaaaaaaaabbabbabbba\nbbbbbbabababbabbbbbbbbba\nbbaaababbaaabbbbaababbbababaaaabaabbbaaaabbbabbabaaabbab\nbbaaaabaaabbbaaabbaaabaa\nbaabbbaababbbbaaaaabbbbbbaaababbbbbbaaba\nabbabbbabaaaaaaabbabaaabaaabababbabaaabaaabbbaaa\naababaaababbbaabababbabbabbbabbbbaaaababaabbabab\nababbbbaaaaaaaabababaabb\nababbbaaaaaabbabbaaabbabbabbaabbaabaaaab\nbbaabaabaaabbaaabbbbbbbb\nbabaababbbbbbaaabbababba\nbbaabbaaaaaabbbbabbbabbbabaabbabababaaba\nbbbbbaaababbabaabbbaabbaaabbbbababbabaabaaaaaabaaabababaaaaaaaabaaaaababbbbbaabababbabbb\naabbbabababbaaabbbbaaaabbabbbbbbabaabaab\nabbbabbaabbbababbbababbabaabaaabbababbab\nbaaaabaaaaabbababbaaaaaabababbbbabbbbababaaaaaaaabbbabab\naabaabababbabbbbbaabbaabbbaabbba\naaaabbbbabbabbabbaabbaabbaaaababababaaaabaabaabbabbbbbaabaaaaaba\nbbbaaaabbaabbaababbabbbaabaababbbbaabbbbbbaabaaaabbbbaabaaaaabba\nbabbaabbaaaabbababaaabbabababbaaabbbababbbbbaabb\naabbbbaaabbbabbbabbababa\naaabaabaabbaaaabababaaabababbaabbabaaabbabaababaabbbaaab\naabbbabbbaababbbbbaaabaaaabaabaabaabaabbbaabbbaabbbaabba\nbbaabbaababbbaabaaaaaabbbbbbbbba\nababbabbabbbaabbabaababaaaaaaaaabbbaabaabbbabbba\nbbbabbabbabbbabbabbaaaaabbabbbabbbaaababababbabbbaaaaaaaaaababaaaabaabaaabbbababbbbaaaab\nbabaaaabababaaaabbabaaaababaababbabaabbabaabaaabaabbabba\naaabaabaabbbaabbbbbbabbababbabab\nbaababbbbabaabbaabbbaaaaabbabbbabbaabaabbababbaabbabbbbaabbbbbbb\nababbaababbabbbbbaababaaababbaba\nbaabbbabaaabbaababaaaabbbabbbaaaaaaaabaaaabbbbabababaabbabaaaabb\nbbbaaababbbbbbaabbbbabbb\nbbbaaaabaabaababaaabbaaaabbabbaaaaaaabbbaaabbabbbbabbaababbaaababaaabbaa\naabbbabaaaaaabbbabbabbba\naaaaaaabababbbabaabbbbba\naaaaaaaaababbbaababababbbbbabbbbabababaaabababaabbbbbaba\nbbaaaaabababaababbbaabbababbaaababbabababbababbaabbababbabaababaaabababbbbbbaaba\nbbaaaabbaaaaaaaababbaaaa\naaaaabaababaababaaababaa\nbabaabbbbaaabbbabbabbbbbbaaabbababaaabaababbaaaa\nbbbbbbaabababbaaaaabbbbabaabbaba\nabaaabbbaababbaaaababbbbbbaaaaababbabaaabbbaababaaababaa\nabbabbbabaaabaabaabbbabbbabbbabaababaaaaaaaaaaabbbbabaaaabbababbbaaaaaaababbabbbabbbbaab\naababbaaaaabaababbbaaabababbababbbbaabbbbabaabbbabaabbaa\nbbaabababbbbaababbaaabbabaaaaabbbabababa\naabbbabaabbbaabaaabbbabaabaababababbaaba\nbbabbaabbbbbbbbabbbbbaaaaabbaaabbbbabbbbbaaabbabbbbbbbbbbbbbbaababbaaabbaaaababbbbbbaaab\nabbbababbbaaaaaabbbabbabbbbabbabbbabaabb\naababbaaabbbaabbababbaaa\nabbabbbbbbbbaababaaabbbb\naaabbbaaaaabbbabbabbaaaa\nababbbbbabbabaabaaaaabaaabbabbaabbbbbaaa\naaaabbbabbbbababbbababbaabbbaabbaaababba\naaabbbabbbaabaababbbaaabbaaaababaabbabaababbabaa\nbaaaabaabaaabaabababaaba\nabbbabbbabbbabbaaaabbaab\nbbabbabbbaaaababbbaaabbaabbabbbbaabbbaaaabbbaabbaabbababababaaba\nabbabbaaaababababaabbbaa\nababbbaabaaabbbabbbabbab\nbbaaabbbbaaaaaababbbaababbabbbaabbaaaabb\nbbabbabbaabbababbaabbabaaaabaaaaabababaaaaabbaab\nbbaababaaaabbbaaaabbbbabbbabaabb\nbbababbaabaabbbababaababaabaaaab\nbababaaaaaaabbbabbbbaabaabbbabaababbbabbababaaba\nbabbaabbbbbbababbbabbbbbbaaaaaabbabbabaaaaabbabb\nbabbbabbabaaabbabbbbaaaa\naaaabbabbbababbabbaaaabaaaabbbaa\nabbbaabaaababaaaabbabbbbbbbaaaaabbabaabbababbaaabbbbbbbabaabaabb\nabbbabaaababaaaaaabaababbbababbaaabbabaabbbbaaabbbbbbaab\nbabbaabbbbbaababbaaabbbbabbaaaaa\nbabbbbbbbbbabaaabaabbbba\nbbbaaabaabaaaaabbaabbababbaabbabbabbababbabbbabaaabbabab\naabbbaaaababbaabbbabaaab\nbbbbbbaaababbbaabaababba\nbbabbbbbbbabaababbbabbba\nbabbabaababbbaaababbabababbbaabbbbaaabbbaaaabbababaababb\nababaaaaaaaaaaabbbaaaabbbaabbbbb\nabbbaaaaaaaaabbaababaabb\nbaabaabaaabbbabaabbabbabaabbbbba\nabaaabbbbbabbbbbbbbaabbbbbaaaabbbbbaabbbbbabbbababbaabaa\naaabbbaaababbbbabbbbabbabaabaabb\nabbabbbbbababaaababbabababbabbbbbaaaaaabbbaabaaaaabaaabb\nababbabbaabbaaabaaababbb\nbbbabaaaabaaaaabbaabbaabbbaababaaaaaababaaabaaabbbbbabaa\nbabbbababbbbbbabaaabaabababbbbbbbaaabbbb\naababaaaababbbaaababbbaababbbaaabbbaabbaaababbba\nababbbbaaabbbaaaaabaababaaaaaaaaabbababababbaaba\naabbaaababbabbaaaaabbbaa\nbbbbaaabbaabbababaabbbabbbabaaabbbabbabababaabab\nbabaababbbbbabababbabbbbbbbbaaaa\nabbbabaaabaaabbbaaabbbaaaaabbabaabbabbaaaabbaabaaabaaabaabbbbabbbabaaabbaababbaabbabaabb\naaabbbbaabbbababababbabbabaaabbabaabaabb\naaabbbaabbbbababbbaababb\nbaabababbbbabbbabbaabbababbbaaabaaababbb\nbbbabaaaabaaaaabbbababab\nbaaaaabbbabbabbbbbaaaabaababbbbaabaabbabbbaaabbaababaaba\nabbaaaabaaabbaaababbabababbbaababbbbbbaabbbbbaaa\nbaabbbabaababaaaabbababa\naabbbabbabaaaaaabbbbbaba\naabbbbaaaaaaababbaabbbaababbabbbaaababbbabaabbbbbabbaaaa\naabbaabbbabaaaabbbabbaab\naabbaaaaabababbbabaaaaaabbbababbaababababbaabbabaaabaaaababbbbab\nbababbaaababaaaabbbbbbbb\naaaaababbbaaaabbbbaabbab\nbaabbaaaaabbbaaabaaababa\nbbbabbbabbaabaaabbbbaabbbbabbbaabbbaaaababbababbbaabababbaabaaab\nbbababababbababbbaaabbaaabbabababbbbbbaabaababaa\naababbaabaaaabbbabababaa\naaabbaaabbbaaaabbbbbaaaa\nbbabbabbabbaaaababbababa\nbbbabaaaaaabbaaaaabbabbbaaabbabaabbabaaa\naaaaaaaabbaababaaabbbbaabaabababbbbbbaab\nbabbaabaababaabaabababaabbbbbbba\naababaaaababbbbbbabbabababababaaabbbaaab\nbaabbbaabbbbbbbbabbaabbb\nbaababbbabbabbabaaaaaababaaabaaa\nababbbababbbbbabbaabbbaa\nbbaababaaabbbbaaababaaababbababa\nbbabbaaaabbabbbbaaabaaab\nabbbabbabbabaabaaaaaaabbabbbbbbbbbbbbaaa\nabbaaabbbbaaabbbbaababbbaaaabaab\nbbaabababaaabbbaabbaabbb\nababbabbaaabaabaaaaaaaabababaaababaaabbbaabbabaabbbbbaba\naababababaaaababbabaaaababaaabbbbaaaaaba\nbabaaabaabbbbbbbabbbbbbbbaababaabbaaabaa\nbababbbabaabbbabaaabbbaaaaabaababaabbbaabbbbbbba\nababbbabbbaaaabaabaabaaa\nababbbbaaabbaaabaababbbbaaaaaaaaabbababb\nbbaabaabaaaabbabaaaaaaabbabbaaaaabbbbbbb\naabaaabbababbbabaaaabaabbbaababb\nbabbbbabaaaabababaababbabaaaabbabbabaaabaaabbbbbbbaabbbb\nbabbaababbbbbbbabbabaabbbbabbaaaababaaaa\nbaabaabababbbbabbaaabaaaabbbaabaaabaabbabbbbabbbabaaaabababaaaabbbbbbabb\nbbbabaabaabbbabbbaabbaabaabaabba\nbabbbababbabbabbabbbaabaaaaabbbbbabaabbbabaaaabbbaaabaaa\naaabbbaababbbaaaaaabbbbaaaaaabbbaaaabbaaaababbbabbbabbba\nbabbaabbababbbbaaababbaabbaaaaaa\nabaababaabbbabaaaaabbaba\nabbabbabaabaaaaaaaabbaba\nbbbbbbaaababbbbaabbaaabbaababbbaaaababbb\nabbaaabbbbbbababaabaaaaaaaaaababbbbabbaa\nabbbabaaaabbaabbaaabababbbbbaaaa\nbbbababbaababbbbbbaaabbbbaabbababaaaaabb\nabbaababaabbbabbabababab\nababbaababaaabbbbababaaaaabababaaaabaabb\naaaaababbabbabaababbabba\naabbaababbaabaaaaaabbabababaaaaa\nbbabbabbaabaabbbbababaaabbbababbababaabb\nbabaaababbababbabbbbbbaabbbaaaaabbaaaabbbaaaaabb\naaabaabaaaaaabbbaaaabababaaabbbbbbbbabbbbaababababaabbbaabaaabaabbabbbba\nbaabababbabaaaabababaaabbaabbbba\nabaaaaaababbbaababbbbbba\nbaabbaaabaabbbabbbabbbaa\nababbbbbabaababaaabbabba\nabbaaabbbabbaaabbbbbbaaa\nababaaaaaabbaabbbbbaaaaaabaabbbabbbabaabbababbabbbbbaaababbbbaab\naabaaaaaaaaabaaabababbbaababaabaaaaabbababaabbababbaaaabbbabaaba\nbabaabababababbbaaabbbaaaabaaaabaaaabbbbaaababaaaababbaabaabaaabababaabb\nababbaabbbabbaababbababa\nababaaabbbaaabaabbbababbbaabaaabaabaaabb\naabbbabaaabaabababaaabbaaaabbabbaaababbb\nbaaabbabbbaaaababaaabaabbaaaabbbabbaaaabaaaabaabbaaabaaa\nbaaaababbaabbbbaaaaabbba\nbbababbaaabaababbbbbbaaa\nbbbaaabaabaaabbabaabaaaa\naabbbbaabaababbaaaabbaab\nababababbbbabbbaabbbbabbbaaababb\nabbaaabbbaaaabbabbbbbaba\naababbaaaaaaababbabbaaba\nabbaaabababbaabaaaaaaabaabbaabaabaabaaababaaaaba\nabaabbbababbbbaabbbbaabb\nabaaabbaaaaabbbbaaabaaaa\nbababbbbbaabbbbbbababbababbbbaba\nabbbabbbabbaaaabbabbbaaaaaabaabababbbbbaabaaabab\nababbbbbbabbbbabaaaaabba\nbaaabbabbaaaaaaaaabbbbaabbbbbaba\naabaaabbabbaabbabaabaaabbabbababaaabbaabaababaab\nabbbbabbaaabbaaaabbbbbaaababbbbbbbbaaabbbabbaaab\nababbaabbbbabaaaabaabbaa\nabababbababbabaabbaaaabaaaaaaabbaaaaaaabaababbababababbbaababbba\naaaaababbaababaaabbbaaababbbbaabbbbabbbaababbaaa\nbbaaaaabbabbaabbbbbbbbba\nababbabbabaaabbbaabababa\nbababbbaabbaaaaabbbbbaab\nabaaaaaabababaaabaabaabaaaaabaaa\nabaaabbaaababaaabbbbbabaababbbbbababaabababbbbbaabbbabbbabbaaabaababbaabbaabbabb\nababaaaabbaabaaaabbabbba\nbbbabaaabbbabaaaabaaaaabbababbaaabababbb\nbbabbabbbaaaaaabbbbbbbbb\nbbbbbbaabbaabaabaaabbabb\nbbbabaaabbabbabbaabbabba\naabaababaaaaaaaaaabbbabaabbbabbaabbbbaabbbbbaaaa\nabbaaabbaaabbbbaaababbab\nabaabababbbabaabbaaaabaaaaabbabbabaabaaa\nbabbbaaabaabbaabbbbaabbbabbbabbababbbababbbabbaa\naaaaaabbbbbaaababbaababb\nabbaaabbbbbbabbabbaabbab\nbbbbabbaabaababaaaaabababaaaabba\nbaaababbbbaaabaaaabababbbbaabbbbbbababab\nbabbbbababbbabbbaaabaaab\nbbaaabbbbbbaabaaaabbbbbbababbbabaaababbabbbbbaba\nbbabababbababbbabbbbbaabbaababbbbbaababaaabbabbababbaaaaababbbbabaaabaabbbbabbaaaabbbaba\nbbaabbbababbbbbbbaaabababbaaabaabbababbaabaaabaababbbaabbbbbbbba\nbaaaabababbaaaaabbabbbbabbbababb\naababbbbbabbaabbbbaaaaabaabbabbabaaababa\nbabbbbaaababbbabbbbbabababaaaaaaabbaaaba\nbabbaabbabbabbabaaabbbaabababaaababbabbaaababaabbabbabbb\nbbaabaabaabaabbbababaabb\naaaabbbababbababbabbabaaaaabbbbabbbababbbbbabbbbbaaaaabb\naabbbbaababbbbababbbbabbbaaabaaa\naaabbbbbabbbaaabbaababaa\nbabaaaabaabbbaaabbaabbaa\naaaaabbbaaabbbbabaaabbabbabbbababbabbbab\nbbbbaababaabababbabbabbb\nabbaababbbaaaababbbaaabaaabbabaa\nababbaabaaabbbabbaabaaab\nbaababbbabaaaaaaabbbabbabbabbabaaababbba\nbaaabbbaaabbbaaababbabaabbbbbaba\nbababbbbababbbbababaababbaabbbaabaaabbbbababaababbbbabbbbabaaababababbaababbbbaa\nabbaaaaabbbbbbababbbbaaa\nbbaabbababbbbaaaabaabababaaaabbababababbbbababbb\nabbbabbaabbaaabbaaabbaba\naaaabbbababbbbabaababaab\nbbaabbaaabaabbbababaaaabbbaabbbabbbabbab\nbabbbbbbbbababbaabaababb\nbbbbabbbaaabbbbbaaaabaabaababaababaabbbb\nbabbbabbaababbaabaaaaabb\nabbbabbbaabbbabbbbaaaaba\nbabababbaabbabbaaabbbbab\nbaaaabaaaaabaabaabbaaaba\nababbaaabbbabbbbabababbabbbbabbb\nbabaabababaaabbabababbaaaabaabaa\nbababbaaabbabbabaaababaa\nbaaaabaaaabbbbbbabbabbba\naabbaababaabbbabbabbbbbbbabbbabbaaaaabba\nabbaabbbabbbbbaabbaabbbbbbbbaababababbabababbaab\nababbbbbabaaaaabbbbaaababbbaabbbaaabaaaabaaaaababaabbbaa\nbabbababababaaaaaababbab\nbabaaabbabaaaaaabbbbaaaa\nbbbbaaaabbbabbbabaabaabbbbbabbab\nbababbaaabbbaababababaaaabbabbbbbbbaababbabbabba\nababbbababaaaaababbabaaa\nbbbbaababababaaaababaabb\nbaaaabbbaabababababbabba\naabbbabbaaabbbabbbaaaaabbbabbaabaaaaaaaabbaaaabaabbaabaa\naabaababaababbabbbbaababaabbbbabaaabbbbbaaabaaabbababbab\nabbabaabbbabbbaaabbaabba\naababaaaaababaaabbaaaabbabbbbbaaabababaa\nbaabbaababbbbaabbabbbaaaabbabaaaaaaabbbabbbaaabaaaabaaabbbaabbaaabbaabbbaabbabaaaaaabaab\nbabbbabbbaababbbabbabaaa\naaababababbbaabbabbabbba\nbabbbbbbaaabbaaabbbbbaab\nabbbaabbaaaaabbbbbabbbab\nbbaabababaabbbabbabababa\nbbabbbbabbbaaaabbaabaabaaabbbabbbbbababb\nabbabbabbbbbaabaababbbbbbbababbaabbbbbbaaabaaabbbbaabbba\nbababaabaababaaabbabbbbb\nbabbaabbbbaabaabbbaabbbabaabbaaabbbbaaabaabbabba\nbbabbaabababbbbabbbabaaa\nbaabbaabaaaaabaabbaaabab\naaabababbabbbaaabaaaabbaaaabbbaabaaaabbbabbbbbabaaaabaababbbbaab\nbaabbbabaabababaaaaabaabaaaaabaaaaaaabbaaabbbaabaabbbbaabaaaabba\nbbaabbaaaabbbaaaabaaabab\nbaaaaaaaaabbbababaaaaabbaabbbbbabbaaabab\naabbaabbabbbaaaabbbabbaaabaabbbbababbaba\nabaabbbaaaabbbaabbaaaabbbaabbbbb\nbbbbabbbaaabaabbaaaaabba\nbabbabaabaaababaabaabbabbbaaaaaa\nabbbbaababbbaabbabaaabbbbaaaaababaaabababbbbbaab\nbbaaaabbbbbbaaabbababaabaaabbbaababbbbabaaabbababbbababaaaaaabbbbbababba\nbaaaabbbbbbbabbabbaababb\nbbaaabbaabbbaaaabaabbaba\nabaaaaabbbbbaabaaababbbbbbbaaaab\naaaabbbaababaaabbbbbabbabbaaaabbaababababbbbbababaabbababbbbaaaabbbaaabb\nabaaabbbbbbaaaaabaabbbaa\naabaababbbabbbbaaaabbbaabbaaaaabaaabaabb\nbababaabbababaabbbaaabaa\nbaaaaaabbabaabbbbabaaabbbbabaabb\nbbabbbbbabbabbababbaaabbbabbababbaabbbbbbbbabbaa\naabbbbbaabbbabbabababbbaaabbbbbaaaabaaab\nbbbabaabaabbbabababbabaababbbbbababbaaaa\naaaabababaaababbbbbbbababbaabbbbbbbbaabbaababbbbaaababaaabbbaababaabbabbbbbbbbbb\naaaabaaabbabbabaabbbaaab\naaaabaabbbbaaaabbaaabaabbababababbbaabaaababbabaaabbabaa\nbbbabaaabaaaabbaabbbbaab\nabbabbbbbbabaaaababbbaabbaaaaababaabbabbbbbaababbabaaaaa\nabbabbaaaaaabababaaabbabaaaaabaabbbaabbaababaaba\naababbbabaababaaabbbaabbbbbbabaaaabbaababababbaaaaaaababbbbbbabbaababbbaaababbaabbbbabab\nabbaaaabbbaaaaabbaabbaaaaabbabbbbbbabaabaabbabbbbbbabbbaabbababb\nbaababbaababbabbbaabbaba\nbbababbaabbaababaaababbabbaaaaabbbabbabaabbbbababbabbbabababaaaa\naabbbbababababbaabaabbaababbbbba\nabaaaabbaaabbaaabbabbbaa\nabbaaabbabaabbbabababaabbbbaabba\nababaaababaaabbbabaaabaa\naabbaabaaabbbbaabaabaaab\naabaabbbabbaaaaaabbbbabaaabaabbaaaababbbaabbabbabbbbaaaaabbaabaa\nbaaabaabbaaaaaaabaaaaaabbababaaaabbbababbbbbaaaa\naababbbabbabaaabbababaaaabaabaaaabbbaaba\nabbabbbabbbabaaabbabababbbabaaaabbaaaaaaaaabababbbabbbab\nbbbabaaaaaaabbabababbaabaaaaabaaabaabbbabbbabbbabaababbbbbababbbaaaaabbb\nbaabababaaaaabbbbbbabbbb\nabbaaabbaaabaabaabaabaab\nabbbbbabbabaaababbabaabbbbabaaaaabbbbaabbaaabababaabaaaabababbbabbabbbaaabbaaabbababbabb\nababaaababaabbbabbbbaabb\nbbaababaabababbaabbbabbbbbabbabaabaabbaa\nbabaabbbababbbbabaaaababbbaaaabababababaabababab\nbbababbabbbbababaabbabaa\nbbaaaabababaababaaaabbbaabaaaaabbaabbbabbbbaabba\nbbabaababbbabaabaabaababababbbaabbbbbaabbbabbaba\nbbababbabbabaaabaaaabbbb\nbaababbbbbaabbaaabaabaaa\nabaaaaaaabbaaaababaabaabbbbbaabbbaaababb\nabaaaabbbabbabababbbbaaa\nabbbababaabbaabbbaaabbaabbbabbbbaabbbbbabbbbaabb\naabbaabbbbabbaaaaabbbbba\nbbbbabbaabaaaabbbaaababbabbababa\nbabbbabaaabaaaaaabbbbbabaabbabab\nbaaaaaababbbababbbbababa\nbaabbaabaabaaaaabaaabaabaaaabaabaabbbbba\naabaabbbbabbababaaabaabaaabaabaa\naabbaabbbabbabbbbababaababaaaaabbbaababaabbabbaabbabaaabbbabbaab\nbbabbaabbabaaabaabbbaabbbbbaaaaaaaaabbaaaabaabaa\nbabbaaabbabaabbbaababbba\naaaaabbbbbaaabbaabbabbaabababbbbaaababba\nbabbbaaaabaaabbabaaabbabbbabbaabbbababbb\nbabbbabbbabbbbaabababbaaabababbbbbaababbbbaabaaabbbbaabb\nbbabbbbbaabbbabbbabaabbbabababaa\nabbbabbabaaabbbbaaaabaaa\nbabbbbaabaaaaaababaabbbb\naaaababababbbaabbbbaabbbbabbaaabbbaaaaaa\nabbbaabbbababaaabaaaaabb\nbbaabbaabbaaabbabbaaabbaabaabaabbaaabbbb\nbababbababbabbbbabababbaaaabaabaaabaaababbaabaabbbabbabbaabbabbbaaaaaaababaaabba\nabbababaaaabaaabbaabbaba\nbaaababbbabaaabaaaaabaaaabaaaaababbbbbbbbabbabbbabbbabaabaababbabaaabbaaaaabaaabaabaaabababbbaab\nbbaaabbbabbabbaaabababab\naabababaabbabbbbbbababbaaaaabbbbabbbbbba\naaaaaabbaaabababaababaaabaaababb\nabbabaabbbbaaaaaabbaaaba\nabbbababaaabaababaaaaaaababaaaababababbbaabbbbba\nabbabbaababbbbababbaaaabbbbaabbbbabbbabbbabbabba\nbbbaabaaaaabbbaababbaabbbbbabaabbaaababaaaaababb\nbbaaaaababaabaaabaaabbaaabbaababbbbaaaabbbbbbaba\nbbaaaabbabbbbbbbaaaaaabbabbbbbabaababbaabaaabaabbbabaaabbaaabbbabbbabaabaaaabbaaaabaaabb\nabbabbaabbaaabbbbabbbbaabbaabaababaabaaaabbbaaababaabaabaaabaaab\nabbbabaaaabbaaabbbbabbaa\nbaabaaaabaaaabbaabaaaaab\naabbbabaabaaabbbbabbabba\nbbababbabbbaabbbbbbaaaabbaaabbabbbaabaaa\naaaabbbbbaaaababaabababababaabba\naabbbabababbbaaaaaabbbbaaaabaaaa\nabbaaaabbababbbaabbabbabababaababbbaaabb\nbaaaaaabbbabaaaaabbaabbb\naaaaaaabbbaaaabaabaaabaa\naabbbbbbbbabbaabababaaba\nbbbbbbaaaaabbaaaabbaabbb\nbbaaabbbbabaaabbbaaaabaaaabbaabababbbabbabaaaabaabababbb\nabbbbbabaabbbabbbbbababb\nabaababaabbbaabbabbbaababbababbbbbbbbbba\naabbbabaaaabbaaabbaabbaaabbbbaaa\naabbabbbaaaabbabababbaba\naaabbbbababbbaaababaabbbbaabbaba\naabbbababbabbaaaabbaaaaaaaaaaaaabbbaabbaaabababb\nababbbabbabaaababbaabbbb\naabbbabbbaabbbabababbabbabbbabbabaaabbbabaabbbbb\nabbbabbaaabbbababbabbbbbbbbbabaabaaaaabbabbbbababbbababb\nbaabaababaaaababbababbbb\nbbaaaaaabaabbbaaaaaabbbaaabbbbabbbaaabbbbbbbbbbbabbbbaaababaabaaaaaaaaabbbabaababaabaabb\naababbbbabaaababbbabbaaaaaaaaabbaabbbbbaaababababababaababbaabababababbbabbbababbbaabaab\nbbabaabaaabbbbbbbababbaa\naaababbabbbbababaababaabbbababaabbbabaababaaaabbaabbbaaa\nbbababbaaabbbaaaabbaabbb\naabbbabaababbbaabbbabaaaaaaabbbabbbbbbaaabbababaabbaaabaabaabbaa\nababbbaaaabaabbbbbbbbbbb\nabbbabaababbabaababaabba\naaabbbaababbabaabbbbaababbabbbab\nbbaaaababaaabbbabbaababbababbababaaabaaa\nbbaaabbaabbaababaaaaabbbbaabbbaaabbbbaaa\naaaaabababbbaaaabbbbbbabbabbbaababbabbaabbbbaabb\naaabbaaaabbbabaabbbbbabbbbaababbbbbbbbbabbaaaabaabbbabbbaaaabbabbbabbaaaaaaaabbbbbabaaba\nbabbbaabbaabaabaaaaabbbabbbbaabaaaabaabbbbabaabb\nabbabbabbabaaabaabbaabaa\nabaaaabbaaaaaaabbaaabbbabbaaabaa\nbbbbbbaababbababababbaba\nbbaaabbaabbbabbbabbaabba\nbabaabbbaabaababaabaabba\nababbbabbabbbaaabababbab\nbbaabbaaaaaaaaabbaabaaaa\nabbbbbabbbbabaaaaaabbbbabbbbbbbabaabbbaaaababbab\nbbbbaababaaabbabababaaba\nbabbabaababbaaabaababbaa\nbabbbaaaababaaababbbabaaabbbabaaabbbbbba\nbbbaabaababbababbbabaabb\naababbbbabbabbbbababbbabbbabbababbababab\nbaaaabbbbaaabbabbaabaabaaababbaaaaaaaabbbaabbbaaaabaaabb\naaaaaaaaababbbbbbbbaaaaabababaaabbbbbaaa\naaaaabababbabaabbabbabaaaaaabaab\nababbbabbabbbaabbaaababb\nabaaabbababaaaababbabbaaabaaabaa\nbabbabbbbabaaabbaabbbbaaabbbabaababbbbbbabaabbabaaabbbba\naaaaabbbabbabbbbbbaaaaaa\naaababbabbabaaabbabbabbb\nbabaabbbabbbabbbaabbbbbbbaabbaabaababbab\naaabbaabbaabbbbaaaaabbabbbaaaabbbaabababaaabbbabbababaaabbaababb\nbabbbbabababbabbbababbab\nbababbbbbaabaaabaabaaababbaabaabaaaaaaabbbababaaaaabaaba\naaaaaaaabaaaabbbbbaaabaa\nbbabbbbbaabaaaaaaaaaabaaabaabababbbbbbaaaaababbaaaababbb\naaabababaababbababbbbbaabbaabbba\nbaababababaaabbbbaaabbbb\nababbbabbaababbbbaaaaaababbbaabbaaaaabaabaabaaaa\nbabbaabbaabbaabbbaaaabbbababbbbbbabbbabbaaaababbbaaabaaaaababbaaaaababbbbbbbabbaaaababaa\naaaaaabbbbabaababbbaaababbababaa\nbabbbbaababbaabbabbbbaba\nbbaabbaaaaaabbbbabababbbbbabbbbbbaaabaaaabbabbbabbabbaaaaaaababa\nababbbaababbbaaaaabaabaa\nbaaaabbbbbbbabbaabbabaaa'.split('\n\n')
    # (rules, input) = '0: 4 1 5\n1: 2 3 | 3 2\n2: 4 4 | 5 5\n3: 4 5 | 5 4\n4: "a"\n5: "b"\n\nababbb\nbababa\nabbbab\naaabbb\naaaabbb'.split('\n\n')
    # (rules, input) = '0: 1 2\n1: "a"\n2: 1 3 | 3 1\n3: "b"\n\naab\naba\nbab\nbba'.split('\n\n')

    rules = rules.split('\n')
    input = input.split('\n')

    max = 0
    for i in input:
        if max < len(i):
            max = len(i)

    max += 1

    ruls = {}
    for r in rules:
        (a, b) = r.split(': ')
        # print(r)
        if b[0] == '\"':
            # print('case 1')
            c = b[1:-1]
            ruls[a] = ([c])
        elif len(b.split(' ')) == 1:
            # print('case 2')
            ruls[a] = ([b])
        elif len(b.split(' | ')) == 1:
            # print('case 3')
            c = b.split(' ')
            ruls[a] = (c)
        else:
            # print('case 4')
            b = b.split(' | ')
            c1 = b[0].split(' ')
            c2 = b[1].split(' ')
            ruls[a] = (c1, c2)
    rules = ruls

    rules['8'] = (['42'],['42', '8'])
    rules['11'] = (['42', '31'],['42', '11', '31'])

    patts = {}
    for i in range(max):
        patts[i+1] = set([])
        for inp in input:
            if i+1 <= len(inp):
                patts[i+1].add(inp[:i+1])

    list = []
    list.append(rules['0'])
    listS = set([])

    i = 0
    while i < len(list):
        if i%10 == 0:
            print('\ri:{:10} l:{:10} %:{}'.format(i, len(list), 100.0*i/len(list)), end='')
        rep = False
        if max < len(list[i]):
            del list[i]
            continue
        for j,e in enumerate(list[i]):
            if 'a' <= e <= 'z':
                if rep == False:
                    if ''.join(list[i][:j+1]) not in patts[j+1]:
                        del list[i]
                        rep = True
                        break
                continue
            tbr = rules[e]
            if type(tbr)==type((1,1)):
                del list[i][j]
                list.append(list[i].copy())
                for k, a in enumerate(tbr[0]):
                    list[i].insert(j+k, a)
                for k, a in enumerate(tbr[1]):
                    list[-1].insert(j+k, a)
                rep = True
                break
            else:
                # print('case 3')
                del list[i][j]
                # print(list[i])
                for k, a in enumerate(tbr):
                    list[i].insert(j+k, a)
                    # print(list[i])
                rep = True
                break
        if rep:
            continue
        listS.add(''.join(list[i-1]))
        # print(len(listS))
        # time.sleep(0.1)
        i += 1
    print()

    count = 0
    for a in input:
        if a in listS:
            count += 1

    print('Part 2:', count+1) # yes yes the +1 is a total bullshit, something does not work

if __name__ == '__main__':

    # part1()
    part2()